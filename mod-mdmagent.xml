<?xml version="1.0" encoding="utf-8"?>
<?xml-stylesheet type="text/xsl" href="../transforms/module/module2html.xsl"?>
<?xml-model href="https://github.com/commoncriteria/transforms/raw/master/schemas/CCModule.rng" type="application/xml" schematypens="http://relaxng.org/ns/structure/1.0"?>

 
<!--  <?xml-model href="../transforms/schemas/CCModule.rng" type="application/xml" schematypens="http://relaxng.org/ns/structure/1.0"?>-->


<!-- To Do
  - Revision History
  - Which SFRs should Agent bring in from each base
  - Refinement - Compare to CC guide and add refinement and bold
  - 
 -->

<!-- DONE:
Consistency Arguments
  ECDs
    threats: objective refers - DONE
  assumptions: objective refers - DONE
  OSPs: objective refers (Organizational Security Policies) - DONE
  TODO :security objectives - DONE; note, changed so they look like the ones in MDF, there are no mappings or rationales
  Free The Toe - Done
  TODO: Need to check the Supporting Document - not all of the EAs are being pulled over: None of the TOE Security Functional Requirements show up in the SD
  
  
  fix table refs in text so that they refer to the correct #s

-->

<!-- Note about format of ECDs
Behavior means it's a new EXT component and we have to make that chart.
            <behavior>
            </behavior>
            -->

<Module boilerplate="yes" target-products="MDM Agents" xmlns="https://niap-ccevs.org/cc/v1"
  name="Mobile Device Management Agent" xmlns:htm="http://www.w3.org/1999/xhtml">
  <PPReference>
    <ReferenceTable>
      <PPVersion>1.0</PPVersion>
      <PPAuthor>National Information Assurance Partnership</PPAuthor>
      <PPPubDate>2019-04-25</PPPubDate>
      <Keywords>Mobile Device Management; MDM; MDM Agents</Keywords>
    </ReferenceTable>
  </PPReference>
  <RevisionHistory>
    <entry>
      <version>1.0</version>
      <date>2013-10-21</date>
      <subject>Initial Release</subject>
    </entry>
    <entry>
      <version>1.1</version>
      <date>2014-02-07</date>
      <subject>Typographical changes and clarifications to front-matter</subject>
    </entry>
    <entry>
      <version>2.0</version>
      <date>2014-12-31</date>
      <subject>Separation of MDM Agent SFRs. Updated cryptography, protocol, X.509 requirements.
        Added objective requirement for Agent audit storage. New requirement for unenrollment
        prevention. Initial Release of MDM Agent EP.</subject>
    </entry>
    <entry>
      <version>3.0</version>
      <date>2016-11-21</date>
      <subject> Updates to align with Technical Decisions. Added requirements to support BYOD use
        case. </subject>
    </entry>
    <entry>
      <version>4.0</version>
      <date>2019-03-01</date>
      <subject><!-- TODO: Add description of what we changed in this version --> Convert to
        PP-Module. </subject>
    </entry>
  </RevisionHistory>
  <chapter id="Introduction" title="Introduction">
    <section id="overview" title="Overview"> The scope of the MDM Agent <abbr linkend="PP-Module"/> is to describe the security functionality of a Mobile Device Management (MDM) Agent in terms of [<abbr linkend="CC"/>] and to define functional and assurance requirements for such products. This <abbr linkend="PP-Module"/> is intended for use with the following <abbr linkend="Base-PP"/>s: <htm:ul>
        <htm:li>Mobile Device Management (MDM) Protection Profile, Version 4.0</htm:li>
        <htm:li>Mobile Device Fundamentals (MDF) Protection Profile, Version 3.1</htm:li>
      </htm:ul>
      <htm:br/> These <abbr linkend="Base-PP"/>s are valid because a <abbr linkend="MDM"/> Agent is
      either a 3rd party application manufactured by the <abbr linkend="MDM"/> Server vendor or is a
      native application deployed on a mobile device. </section>

      <tech-terms>
            <term full="Administrator">The person who is responsible for management activities, including setting
            the policy that is applied by the enterprise on the mobile device.</term>
	    <term abbr="API" full="Application Programming Interface"/>
	    <term abbr="BYOD" full="Bring Your Own Device"/>
	    <term abbr="COPE" full="Corporately Owned, Personally Enabled"/>
	    <term abbr="DN" full="Distinguished Name"/>
	    <term abbr="DTLS" full="Datagram Transport Layer Security"/>
            <term full="Enrolled State">The state in which a mobile device is managed by a policy from an MDM.</term>
	    <term abbr="GPOS" full="General Purpose Operating System"/>
	    <term abbr="HTTPS" full="HyperText Transfer Protocol Secure"/>
	    <term abbr="IP" full="Internet Protocol"/>
	    <term abbr="IPSec" full="Internet Protocol Security"/>
            <term full="Mobile Application Store" abbr="MAS">Mobile Application Store</term>
            <term full="Mobile Device Management" abbr="MDM">Mobile Device Management</term>
            <term full="Mobile Device User">The person who uses and is held responsible for a mobile device.</term>
	    <term abbr="MD" full="Mobile Device"/>
	    <term abbr="MDF" full="Mobile Device Fundamentals"/>
            <term full="Operating System">
	      Software which runs at the highest privilege level and can directly control
              hardware resources. Modern mobile devices typically have at least two primary
              operating systems: one which runs on the cellular baseband processor and one which
              runs on the application processor. The platform of the application processor handles
              most user interaction and provides the execution environment for apps. The platform of
              the cellular baseband processor handles communications with the cellular network and
              may control other peripherals. The term OS, without context, may be assumed to refer
              to the platform of the application</term>
	      <term abbr="RBG" full="Random Bit Generation"/>
	      <term abbr="SD" full="Supporting Document"/>
	      <term abbr="ST" full="Security Target"/>
	      <term abbr="TLS" full="Transport Layer Security"/>
              <term full="Unenrolled State">
		The state in which a mobile device is not managed by an MDM system.
	      </term>
              <term full="User">See Mobile Device User.</term>
	      <term abbr="VPN" full="Virtual Private Network"/>
	      <term abbr="WiFi" full="Wireless Fidelity"/>
      </tech-terms>

    <section id="targets" title="Compliant Targets of Evaluation"> 
      The <abbr linkend="MDM"/> system
      consists of two primary components: the <abbr linkend="MDM"/> Server software and the <abbr
        linkend="MDM"/> Agent. This <abbr linkend="PP-Module"/> specifically addresses the <abbr
        linkend="MDM"/> Agent. The <abbr linkend="MDM"/> Agent establishes a secure connection back
      to the <abbr linkend="MDM"/> Server, from which it receives policies to enforce on the mobile
      device. Optionally, the <abbr linkend="MDM"/> Agent interacts with the Mobile Application
      Store (MAS) Server to download and install enterprise-hosted applications.<htm:br/><htm:br/> A
      compliant <abbr linkend="MDM"/> Agent is installed on a mobile device as an application
      (supplied by the developer of the <abbr linkend="MDM"/> Server software) or is part of the
      mobile device's OS.This <abbr linkend="PP-Module"/> builds on either the MDF PP or the MDM PP. A TOE
      that claims conformance to this <abbr linkend="PP-Module"/> must also claim conformance to one
      of those PPs as its <abbr linkend="Base-PP"/>. A compliant <abbr linkend="TOE"/> is obligated
      to implement the functionality required in the <abbr linkend="Base-PP"/> along with the
      additional functionality defined in this <abbr linkend="PP-Module"/> in order to mitigate the
      threats that are defined by this <abbr linkend="PP-Module"/>.<htm:br/><htm:br/> This <abbr
        linkend="PP-Module"/> shall build on the MDF PP if the <abbr
        linkend="TOE"/> is a native part of a mobile operating system. The <abbr linkend="TOE"/> for
      this <abbr linkend="PP-Module"/> combined with the MDF <abbr linkend="PP"/> is the mobile
      device itself plus the <abbr linkend="MDM"/> Agent. If the <abbr linkend="MDM"/> Agent is part
      of the mobile device’s OS, the <abbr linkend="MDM"/> Agent may present multiple interfaces for
      configuring the mobile device, such as a local interface and a remote interface. Agents
      conforming to this <abbr linkend="PP-Module"/> must at least offer an interface with a trusted
      channel that serves as one piece of an <abbr linkend="MDM"/> system. Conformant <abbr
        linkend="MDM"/> Agents may also offer other interfaces, and the configuration aspects of
      these additional interfaces are in scope of this <abbr linkend="PP-Module"
      />.<htm:br/><htm:br/> This <abbr linkend="PP-Module"/> shall build on the <abbr linkend="MDM"
      /> Server PP if the <abbr linkend="TOE"/> is a third-party application that is provided with
      an <abbr linkend="MDM"/> Server and installed on a mobile device by the user after acquiring
      the mobile device. The distributed <abbr linkend="TOE"/> for this <abbr linkend="PP-Module"/>
      combined with the <abbr linkend="MDM"/> Server <abbr linkend="PP"/> is the entire <abbr
        linkend="MDM"/> environment, which includes both the <abbr linkend="MDM"/> Server and the
        <abbr linkend="MDM"/> Agent. Even though the mobile device itself is not part of the <abbr
        linkend="TOE"/>, it is expected to be evaluated against the MDF <abbr linkend="PP"/> so that
      its baseline security capabilities can be assumed to be present. <subsection
        title="TOE Boundary" id="toeboundary"> Figure 1 shows a high-level example of the <abbr
          linkend="PP-Module"/>
        <abbr linkend="TOE"/> boundary and its Operational Environment. As stated above, the <abbr
          linkend="MDM"/> Agent may either be provided as part of the mobile device itself (shown in
        red) or distributed as a third-party application from the developer of the <abbr
          linkend="MDM"/> Server software (shown in blue).<htm:br/><htm:br/>
        <figure entity="images/MDMagentoperatingenvironment.jpg"
          title="MDM Agent Operating Environment" id="toe"/><htm:br/> The <abbr linkend="MDM"/>
        Agent must closely interact with or be part of the mobile device’s platform in order to
        establish policies and to perform queries about device status. The mobile device, in turn,
        has its own security requirements specified in the MDF <abbr linkend="PP"/>. </subsection>
    </section>
    <section title="Use Cases" id="usecase"> This <abbr linkend="PP-Module"/> defines 4 use cases:<htm:br/><htm:br/>
      <usecases>
        <usecase title="Enterprise-owned device for general-purpose enterprise use" id="usecase1">
          <description> An Enterprise-owned device for general-purpose business use is commonly
            called Corporately Owned, Personally Enabled (COPE). This use case entails a significant
            degree of Enterprise control over configuration and software inventory. Enterprise
            administrators use an <abbr linkend="MDM"/> product to establish policies on the mobile
            devices prior to user issuance. Users may use Internet connectivity to browse the web or
            access corporate mail or run Enterprise applications, but this connectivity may be under
            significant control of the Enterprise. The user may also be expected to store data and
            use applications for personal, non-enterprise use. The Enterprise administrator uses the
              <abbr linkend="MDM"/> product to deploy security policies and query mobile device
            status. The <abbr linkend="MDM"/> may issue commands for remediation actions.
          </description>
        </usecase>
        <usecase title="Enterprise-owned device for specialized, high-security use" id="usecase2">
          <description>An Enterprise-owned device with intentionally limited network connectivity,
            tightly controlled configuration, and limited software inventory is appropriate for
            specialized, high-security use cases. As in the previous use case, the <abbr
              linkend="MDM"/> product is used to establish such policies on mobile devices prior to
            issuance to users. The device may not be permitted connectivity to any external
            peripherals. It may only be able to communicate via its Wi-Fi or cellular radios with
            the Enterprise-run network, which may not even permit connectivity to the Internet. Use
            of the device may require compliance with usage policies that are more restrictive than
            those in any general-purpose use case, yet may mitigate risks to highly sensitive
            information. Based upon the operation environment and the acceptable risk level of the
            enterprise, those security functional requirements outlined in <secref linkend="sfr"/>
            of this Protection Profile along with the selections in the Use Case 2 template defined
            in <appref linkend="use-case"/> are sufficient for the high-security use case.
          </description>
        </usecase>
        <usecase title="Personally owned device for personal and enterprise use" id="usecase3">
          <description>A personally owned device, which is used, for both personal activities and
            enterprise data is commonly called Bring Your Own Device (BYOD). The device may be
            provisioned for access to enterprise resources after significant personal usage has
            occurred. Unlike in the enterprise-owned cases, the enterprise is limited in what
            security policies it can enforce because the user purchased the device primarily for
            personal use and is unlikely to accept policies that limit the functionality of the
            device.<htm:br/><htm:br/> However, because the Enterprise allows the user full (or
            nearly full) access to the Enterprise network, the Enterprise will require certain
            security policies, for example a password or screen lock policy, and health reporting,
            such as the integrity of the mobile device system software, before allowing access. The
            administrator of the <abbr linkend="MDM"/> can establish remediation actions, such as
            wipe of the Enterprise data, for non-compliant devices. These controls could potentially
            be enforced by a separation mechanism built-in to the device itself to distinguish
            between enterprise and personal activities, or by a third-party application that
            provides access to enterprise resources and leverages security capabilities provided by
            the mobile device. Based upon the Operational Environment and the acceptable risk level
            of the enterprise, those security functional requirements outlined in <secref
              linkend="sfr"/> of this Protection Profile along with the selections in the Use Case 3
            template defined in <appref linkend="use-case"/> are sufficient for the secure
            implementation of this BYOD use case.</description>
        </usecase>
        <usecase title="Personally owned device for personal and limited enterprise use"
          id="usecase4">
          <description>A personally owned device may also be given access to limited enterprise
            services such as enterprise email. Because the user does not have full access to the
            enterprise or enterprise data, the enterprise may not need to enforce any security
            policies on the device. However, the enterprise may want secure email and web browsing
            with assurance that the services being provided to those clients by the mobile device
            are not compromised. Based upon the Operational Environment and the acceptable risk
            level of the enterprise, those security functional requirements outlined in <secref
              linkend="sfr"/> of this <abbr linkend="PP"/> are sufficient for the secure
            implementation of this BYOD use case.</description>
        </usecase>
      </usecases>
    </section>
  </chapter>
  <chapter title="Conformance Claims" id="conf">
    <cclaims>
      <cclaim title="Conformance Statement">
        <description> This <abbr linkend="PP-Module"/> inherits exact conformance as required from
          the specified <abbr linkend="Base-PP"/> and as defined in the <abbr linkend="CC"/> and
            <abbr linkend="CEM"/> addenda for Exact Conformance, Selection-Based SFRs, and Optional
          SFRs (dated May 2017).<htm:br/><htm:br/> The following PPs and PP-Modules are allowed to
          be specified in a PP-Configuration with this PP-Module. <htm:ul>
            <htm:li>PP-Module for VPN Client, Version 2.1</htm:li>
          </htm:ul>
        </description>
      </cclaim>
      <cclaim title="CC Conformance Claims">
        <description>This <abbr linkend="PP-Module"/> is conformant to Parts 2 (extended) and 3
          (conformant) of Common Criteria Version 3.1, Release 5 [<abbr linkend="CC"/>].
        </description>
      </cclaim>
      <cclaim title="Package Claims">
        <description>This <abbr linkend="PP-Module"/> is TLS Package Version 1.1
          Conformant.</description>
      </cclaim>
    </cclaims>
  </chapter>
  <chapter id="spd" title="Security Problem Description">
    <section id="threats" title="Threats"> The following threats are specific to <abbr linkend="MDM"
      /> Agents, and represents an addition to those identified in the <abbr linkend="Base-PP"/>s. 
      <!-- Note: Threats contained in both base-PPs should not be listed in the PP-Module (section 3.1 or 6), but objectives can still be mapped to them (section 4.3). 
        For these threats do not include a <description> or <consistency-rationale> section. If a <description> section is included then the threat is listed in Section 3.1. 
        If no description is listed, then threat is only listed in section 4.3 (not in 3.1 or 6) -->
      <threats>
        <threat name="T.MALICIOUS_APPS">
	  <description>
	    FILL IN
	  </description>
          <objective-refer ref="O.DATA_PROTECTION_TRANSIT">
            <rationale>The threat T.MALICIOUS_APPS is countered by O.DATA_PROTECTION_TRANSIT as this
              provides the capability to protect app loading/updates against malicious insertion
              from the network.</rationale>
          </objective-refer>
          <objective-refer ref="O.APPLY_POLICY">
            <rationale>The threat T.MALICIOUS_APPS is countered by O.APPLY_POLICY as this provides
              policy preventing loading of unapproved apps into the <abbr linkend="TOE"
              />.</rationale>
          </objective-refer>
        </threat>
        <threat name="T.BACKUP">
          <description> An attacker may try to target backups of data or credentials and exfiltrate
            data. Since the backup is stored on either a personal computer or end user’s backup
            repository, it’s not likely the enterprise would detect compromise.</description>
          <objective-refer ref="O.DATA_PROTECTION_TRANSIT">
            <rationale>The threat T.BACKUP is countered by O.DATA_PROTECTION_TRANSIT as this
              provides the capability to communicate using one (or more) standard protocols as a
              means to maintain the confidentiality of data that are transmitted between the Agent
              and other entities.</rationale>
          </objective-refer>
          <objective-refer ref="O.APPLY_POLICY">
            <rationale>The threat T.BACKUP is countered by O.APPLY_POLICY as this provides policy to
              enforce that backups be stored only in secure, protected locations.</rationale>
          </objective-refer>
        </threat>
        <threat name="T.NETWORK_ATTACK">
	  <description>FILL IN</description>
          <objective-refer ref="O.DATA_PROTECTION_TRANSIT">
            <rationale>The threat T.NETWORK_ATTACK is countered by O.DATA_PROTECTION_TRANSIT as this
              provides the capability to communicate using one (or more) standard protocols as a
              means to maintain the confidentiality of data that are transmitted between the Agent
              and other entities.</rationale>
          </objective-refer>
          <objective-refer ref="O.APPLY_POLICY">
            <rationale>The threat T.NETWORK_ATTACK is countered by O.APPLY_POLICY as this provides a
              secure configuration of the Agent to protect data that it processes.</rationale>
          </objective-refer>
          <objective-refer ref="OE.IT_ENTERPRISE">
            <rationale>The threat T.NETWORK_ATTACK is countered by OE.IT_ENTERPRISE by reducing the network exposure of the
              mobile device.</rationale>
          </objective-refer>
        </threat>
        <threat name="T.NETWORK_EAVESDROP">
	  <description>FILL IN</description>
          <objective-refer ref="O.DATA_PROTECTION_TRANSIT">
            <rationale>The threat T.NETWORK_EAVESDROP is countered by O.DATA_PROTECTION_TRANSIT as
              this provides the capability to communicate using one (or more) standard protocols as
              a means to maintain the confidentiality of data that are transmitted between the Agent
              and other entities.</rationale>
          </objective-refer>
          <objective-refer ref="O.APPLY_POLICY">
            <rationale>The threat T.NETWORK_EAVESDROP is countered by O.APPLY_POLICY as this
              provides a secure configuration of the Agent to protect data that it
              processes.</rationale>
          </objective-refer>
          <objective-refer ref="OE.IT_ENTERPRISE">
            <rationale>
              The threat T.NETWORK_EAVESDROP is countered by OE.IT_ENTERPRISE by reducing the network exposure of the
              mobile device.  
            </rationale>
          </objective-refer>
        </threat>
        <threat name="T.PHYSICAL_ACCESS">
	  <description> FILL IN </description>
          <objective-refer ref="O.ACCOUNTABILITY">
            <rationale>The threat T.PHYSICAL_ACCESS is countered by O.ACCOUNTABILITY as this
              provides the capability to log attempts by unauthorized personnel to access data, and
              to log any access to the data or the device, as well as changes to the device during
              the time when it is not under the control of an authorized user.</rationale>
          </objective-refer>
          <objective-refer ref="O.APPLY_POLICY">
            <rationale>The threat T.PHYSICAL_ACCESS is countered by O.APPLY_POLICY as this provides
              a secure configuration of the Agent to protect data that it processes.</rationale>
          </objective-refer>
          <objective-refer ref="O.STORAGE"> 
            <rationale>The threat T.PHYSICAL_ACCESS is countered by O.STORAGE as this provides the capability to encrypt all user and enterprise data and authentication keys to ensure the confidentiality of data that it stores.</rationale>
          </objective-refer>
        </threat>        
      </threats>
    </section>
    <section id="Assumptions" title="Assumptions">
      <assumptions>
        <assumption name="A.CONNECTIVITY">
          <description>The <abbr linkend="TOE"/> relies on network connectivity to carry out its
            management activities. The <abbr linkend="TOE"/> will robustly handle instances when
            connectivity is unavailable or unreliable. </description>
          <objective-refer ref="OE.WIRELESS_NETWORK">
            <rationale>The Operational Environment objective OE.WIRELESS_NETWORK is realized through
              A.CONNECTIVITY. </rationale>
          </objective-refer>
        </assumption>
        <assumption name="A.MOBILE_DEVICE_PLATFORM">
          <description>The MDM Agent relies upon mobile platform and hardware evaluated against the
            MDF PP and assured to provide policy enforcement as well as cryptographic services and
            data protection. The mobile platform provides trusted updates and software integrity
            verification of the MDM Agent. </description>
          <objective-refer ref="OE.MOBILE_DEVICE_PLATFORM">
            <rationale>The Operational Environment objective OE.MOBILE_DEVICE_PLATFORM is realized
              through A.MOBILE_DEVICE_PLATFORM. </rationale>
          </objective-refer>
        </assumption>
        <assumption name="A.PROPER_ADMIN">
          <description>One or more competent, trusted personnel who are not careless, willfully
            negligent, or hostile, are assigned and authorized as the <abbr linkend="TOE"/>
            Administrators, and do so using and abiding by guidance documentation. </description>
          <objective-refer ref="OE.DATA_PROPER_ADMIN">
            <rationale>The Operational Environment objective OE.DATA_PROPER_ADMIN is realized
              through A.PROPER_ADMIN. </rationale>
          </objective-refer>
        </assumption>
        <assumption name="A.PROPER_USER">
          <description> Mobile device users are not willfully negligent or hostile, and use the
            device within compliance of a reasonable Enterprise security policy. </description>
          <objective-refer ref="OE.DATA_PROPER_USER">
            <rationale>The Operational Environment objective OE.DATA_PROPER_USER is realized through
              A.PROPER_USER. </rationale>
          </objective-refer>
        </assumption>
      </assumptions>
    </section>
    <section id="securityPolicy" title="Organizational Security Policies">
      <OSPs>
        <OSP name="P.ACCOUNTABILITY">
          <description>Personnel operating the <abbr linkend="TOE"/> shall be accountable for their
            actions within the <abbr linkend="TOE"/>. </description>
          <objective-refer ref="O.ACCOUNTABILITY">
            <rationale>O.ACCOUNTABILITY provides logging of personnel actions in order to provide
              accountability of all personnel actions within the <abbr linkend="TOE"/>. </rationale>
          </objective-refer>
        </OSP>
        <OSP name="P.ADMIN">
          <description>The configuration of the mobile device security functions must adhere to the
            Enterprise security policy. </description>
          <objective-refer ref="O.APPLY_POLICY">
            <rationale>The <abbr linkend="TOE"/> adheres to the Enterprise security policy through
              the application of O.APPLY_POLICY. </rationale>
          </objective-refer>
        </OSP>
        <OSP name="P.DEVICE_ENROLL">
          <description>A mobile device must be enrolled for a specific user by the administrator of
            the <abbr linkend="MDM"/> prior to being used in the Enterprise network by the user. </description>
          <objective-refer ref="O.APPLY_POLICY">
            <rationale>The <abbr linkend="TOE"/> enrolls mobile devices for specific users with
              policy through the application of O.APPLY_POLICY. </rationale>
          </objective-refer>
        </OSP>
        <OSP name="P.NOTIFY">
          <description>The mobile user must immediately notify the administrator if a mobile device
            is lost or stolen so that the administrator may apply remediation actions via the <abbr
              linkend="MDM"/> system. </description>
          <objective-refer ref="O.APPLY_POLICY">
            <rationale>The <abbr linkend="TOE"/> provides the capability for the administrator to
              apply remediation actions via the <abbr linkend="MDM"/> system through policy, which
              is applied through O.APPLY_POLICY. </rationale>
          </objective-refer>
        </OSP>
      </OSPs>
    </section>
  </chapter>
  <chapter title="Security Objectives" id="objectives">
    <section id="TOEobjectives" title="Security Objectives for the TOE">
      <SOs>
        <SO name="O.ACCOUNTABILITY">
          <description>The <abbr linkend="TOE"/> must provide logging facilities, which record
            management actions undertaken by its administrators. </description>
            <addressed-by>FAU_ALT_EXT.2, FAU_GEN.1(2), FAU_SEL.1(2)</addressed-by>
	    <rationale>FILL IN</rationale>
            <consistency-rationale><!-- Note: different per base, so defined as a con-mod under each base--></consistency-rationale>
        </SO>
        <SO name="O.APPLY_POLICY">
          <description>The <abbr linkend="TOE"/> must facilitate configuration and enforcement of
            enterprise security policies on mobile devices via interaction with the mobile OS and
            the <abbr linkend="MDM"/> Server. This will include the initial enrollment of the device
            into management, through its entire lifecycle, including policy updates and its possible
            unenrollment from management services. </description>
            <addressed-by>FAU_STG_EXT.3(objective), FIA_ENR_EXT.2, FMT_POL_EXT.2, FMT_SMF_EXT.4,FMT_UNR_EXT.1</addressed-by>
	    <rationale>FILL IN </rationale>
          <consistency-rationale><!-- Note: different per base, so defined as a con-mod under each base-->
          </consistency-rationale>
        </SO>
        <SO name="O.DATA_PROTECTION_TRANSIT">
          <description>Data exchanged between the <abbr linkend="MDM"/> Server and the <abbr
          linkend="MDM"/> Agent must be protected from being monitored, accessed, or altered. </description>
	  <addressed-by>
          <!--  <component-refer ref="FCS_CKM_EXT.4 (from MDM/MDF PP)"/>  
          <component-refer ref="FCS_CKM.1 (from MDM/MDF PP)"/>
          <component-refer ref="FCS_CKM.2 (from MDM PP)"/> 
          <component-refer ref="FCS_CKM.2(1) (from MDF PP)"/> 
          <component-refer ref="FCS_COP.1(*) (from MDM/MDF PP)"/>  -->
          FCS_DTLSS_EXT.1 (from TLS Package),
	  FCS_DTLSC_EXT.1 (from TLS Package),
          <!--  <component-refer ref="FCS_HTTPS_EXT.1 (from MDM/MDF PP)"/>
          <component-refer ref="FCS_RBG_EXT.1 (from MDM/MDF PP)"/>    -->
          FCS_TLSC_EXT.1 (from TLS Package),
	  FCS_TLSC_EXT.2 (from TLS Package),
	  FCS_TLSS_EXT.1 (from TLS Package),
	  FCS_TLSS_EXT.2 (from TLS Package),
          <!--  <component-refer ref="FIA_X509_EXT.1(*) (from MDM/MDF PP)"/> 
          <component-refer ref="FIA_X509_EXT.2 (from MDM/MDF PP)"/> 
          <component-refer ref="FIA_X509_EXT.3 (from MDM/MDF PP)"/>
          <component-refer ref="FIA_X509_EXT.4 (from MDM PP)"/>  -->
          <!--  <component-refer ref="FPT_ITT.1(2) (if MDM is Base-PP)"/>--> 
	  FPT_NET_EXT.1 (objective),
	  FTP_ITC_EXT.1(2) (if MDF is Base-PP),
          <!--  <component-refer ref="FTP_TRP.1(1) (from MDM PP)"/>-->
	  FTP_TRP.1(2) (if MDF is Base-PP)
	  </addressed-by>
	  <rationale>FILL IN</rationale>
          <consistency-rationale> This objective extends the <abbr linkend="Base-PP"/>’s O.COMMS
            objective by ensuring that the communications related to <abbr linkend="MDM"/> Agents
            functionality are secured in the same manner as other sensitive data transmitted to/from
            the mobile device. </consistency-rationale>
        </SO>
        <SO name="O.STORAGE">
          <description> To address the issue of loss of confidentiality of user data in the event of
            loss of a mobile device (T.PHYSICAL), conformant <abbr linkend="TOE"/>s will use
            platform provide key storage. The <abbr linkend="TOE"/> is expected to protect its
            persistent secrets and private keys. </description>
            <addressed-by>
	      FCS_STG_EXT.1(2) (if MDM is Base-PP),
              FCS_STG_EXT.4 (if MDF is Base-PP)
	    </addressed-by>
	    <rationale> FILL IN</rationale>
	    <consistency-rationale> This objective extends the <abbr linkend="Base-PP"/>’s O.STORAGE
            objective by ensuring that the mobile device’s data-at-rest protection mechanisms can
            also be used to secure the <abbr linkend="MDM"/> Agent and related data.
          </consistency-rationale>
        </SO>
      </SOs>
    </section>
    <section id="objectivesEnvironment" title="Security Objectives for the Operational Environment">
      <SOEs>
        <SOE name="OE.DATA_PROPER_ADMIN">
          <description>TOE Administrators are trusted to follow and apply all administrator guidance
            in a trusted manner. </description>
          <consistency-rationale><!-- Note: different per base, so defined as a con-mod under each base--></consistency-rationale>
        </SOE>
        <SOE name="OE.DATA_PROPER_USER">
          <description>Users of the mobile device are trained to securely use the mobile device and
            apply all guidance in a trusted manner. </description>
          <consistency-rationale><!-- Note: different per base, so defined as a con-mod under each base--></consistency-rationale>
        </SOE>
        <SOE name="OE.IT_ENTERPRISE">
          <description>The Enterprise IT infrastructure provides security for a network that is
            available to the <abbr linkend="TOE"/> and mobile devices that prevents unauthorized
            access. </description>
          <consistency-rationale><!-- Note: different per base, so defined as a con-mod under each base--></consistency-rationale>
        </SOE>
        <SOE name="OE.MOBILE_DEVICE_PLATFORM">
          <description>The <abbr linkend="MDM"/> Agent relies upon the trustworthy mobile platform
            and hardware to provide policy enforcement as well as cryptographic services and data
            protection. The mobile platform provides trusted updates and software integrity
            verification of the <abbr linkend="MDM"/> Agent. </description>
          <consistency-rationale><!-- Note: different per base, so defined as a con-mod under each base--></consistency-rationale>
        </SOE>
        <SOE name="OE.WIRELESS_NETWORK">
          <description>A wireless network will be available to the mobile devices. </description>
          <consistency-rationale><!-- Note: different per base, so defined as a con-mod under each base--></consistency-rationale>
        </SOE>
      </SOEs>
    </section>
    <section title="Security Objectives Rationale" id="rationale">
      <!-- Note: This section should remain empty and is populated from the rationale tags in the previous sections.  -->
    </section>
  </chapter>
  <chapter id="sfr" title="Security Requirements">
    <base-pp version="3.1" name="Mobile Device Fundamentals" product="Mobile Device" short="MDF"
      url="https://www.niap-ccevs.org/Profile/Info.cfm?PPID=417&amp;id=417"
      xmlurl="https://raw.githubusercontent.com/commoncriteria/mobile-device/master/input/mobile-device.xml">
      <!--   <app-unmod-sfrs> 
        The SFRs listed in this section are defined in the MDF PP and relevant to the secure operation of the MDM Agent. While testing the TOE, it is necessary to ensure these SFRs are tested specifically in conjunction with the MDM Agent portion of the TOE. The ST author may complete all selections and assignments in these SFRs without any additional restrictions.
        <htm:ul>
          <htm:li>FCS_CKM.1</htm:li>
          <htm:li>FCS_CKM.2(1)</htm:li> 
          <htm:li>FCS_CKM_EXT.4</htm:li>
          <htm:li>FCS_COP.1(*)</htm:li>
          <htm:li>FCS_RBG_EXT.1</htm:li>
          <htm:li>FCS_TLSC_EXT.1</htm:li> 
          <htm:li>FIA_X509_EXT.1</htm:li>
          <htm:li>FIA_X509_EXT.2</htm:li>
          <htm:li>FIA_X509_EXT.3</htm:li>
          <htm:li>FPT_TST_EXT.1</htm:li>
          <htm:li>FCS_DTLS_EXT.1</htm:li>
          <htm:li>FCS_HTTPS_EXT.1</htm:li>
        </htm:ul>
      </app-unmod-sfrs>-->
      <modified-sfrs/>
      <additional-sfrs>
        <subsection id="crypto-fcs" title="Cryptographic Support (FCS)">
          <ext-comp-def fam-id="FCS_STG_EXT" title="Trusted Channel">
            <mod-def> This family is defined in both the MDF and the MDM <abbr linkend="Base-PP"/>s. This <abbr linkend="PP-Module"/> augments the extended family by adding one additional component, FCS_STG_EXT.4. This new component and its impact on the extended family’s component leveling are shown below; reference the MDF or MDM PP for all other definitions for this family. </mod-def>
          </ext-comp-def>
          <f-component cc-id="fcs_stg_ext.4" name="Cryptographic Key Storage">
            <consistency-rationale> This SFR requires the <abbr linkend="MDM"/> Agent to use
              functionality defined by the <abbr linkend="Base-PP"/> in FCS_CKM_EXT.1. </consistency-rationale>
            <comp-lev> requires the TSF to define a specific location for its key
              storage.</comp-lev>
            <management>There are no management functions foreseen.</management>
            <audit>There are no auditable events foreseen.</audit>
            <dependencies>FCS_CKM.1 Cryptographic Key Generation</dependencies>
            <f-element>
              <title>The <abbr linkend="MDM"/> Agent shall use the platform provided key storage for
                all persistent secret and private keys.</title>
              <note role="application">This requirement ensures that persistent secrets
                (credentials, secret keys) and private keys are stored securely when not in use by
                the mobile platform. </note>
              <aactivity>
                <TSS> The evaluator will verify that the <abbr linkend="TSS"/> lists each persistent
                  secret (credential, secret key) and private key needed to meet the requirements in
                  the <abbr linkend="ST"/>. For each of these items, the evaluator will confirm that
                  the <abbr linkend="TSS"/> lists for what purpose it is used, and, for each
                  platform listed as supported in the <abbr linkend="ST"/>, how it is stored. The
                  evaluator shall verify that the Agent calls a platform-provided API to store
                  persistent secrets and private keys. </TSS>
              </aactivity>
            </f-element>
          </f-component>
        </subsection>
        <subsection id="trust-path-ftp" title="Trusted Path/Channels (FTP)">
          <f-component cc-id="ftp_itc_ext.1" name="Trusted Channel Communication" iteration="TRUSTCHAN">
            <consistency-rationale> The <abbr linkend="Base-PP"/> defines FTP_ITC_EXT.1 to define the secure protocols used for trusted channel communications. This <abbr linkend="PP-Module"/> iterates the SFR to specify a subset of these protocols that may be used for <abbr linkend="MDM"/> Agent communications in particular. </consistency-rationale>
            <f-element id="mut-chan-type">
              <title><htm:b>Refinement:</htm:b> The TSF shall use <selectables linebreak="yes">
                  <selectable>mutually authenticated TLS client as defined in the Package for
                    Transport Layer Security</selectable>
                  <selectable>mutually authenticated DTLS client as defined in the Package for
                    Transport Layer Security</selectable>
                  <selectable>HTTPS</selectable>
                </selectables> to provide a communication channel between itself and another trusted
                IT product that is logically distinct from other communication channels, provides
                assured identification of its end points, protects channel data from disclosure, and
                detects modification of the channel data.</title>
              <note role="application"> The intent of this requirement is to protect the
                communications channel between <abbr linkend="MDM"/> Server and Agent, post
                enrollment. <linkref linkend="FTP_TRP.1(2)"/> is to protect the communications
                channel between <abbr linkend="MDM"/> Server and Agent during enrollment.
                <htm:br/><htm:br/> This requirement is to ensure that the transmission of any audit
                logs, mobile device information data (software version, hardware model, and
                application versions), and configuration data collected by the <abbr linkend="MDM"/>
                Agent and sent from the <abbr linkend="MDM"/> Agent to the <abbr linkend="MDM"/>
                Server, when commanded, or at configurable intervals, is properly protected. This
                trusted channel also protects any commands and policies sent by the <abbr
                  linkend="MDM"/> Server to the <abbr linkend="MDM"/> Agent. Either the <abbr
                  linkend="MDM"/> Agent or the <abbr linkend="MDM"/> Server is able to initiate the
                connection.<htm:br/><htm:br/> This requirement is iterated from the MDF <abbr
                  linkend="PP"/> to indicate the protocols that the MDM Agent can use for a trusted
                channel. The mobile device is required to perform the mandated cryptographic
                protocols as in the <abbr linkend="Base-PP"/> for communication channels mandated in
                the MDF <abbr linkend="PP"/>. The <abbr linkend="ST"/> author must select one of
                TLS, DTLS, or HTTPS in order to establish and maintain a trusted channel between the
                  <abbr linkend="MDM"/> Agent and the <abbr linkend="MDM"/> Server. Only TLS, DTLS,
                or HTTPS are acceptable for this trusted channel.<htm:br/><htm:br/> Since this
                requirement is only for the case when the <abbr linkend="PP-Module"/> builds on MDF
                PP and in this case it is expected that the <abbr linkend="MDM"/> Agent will be a
                native part of the mobile operating system, it is expected that the <abbr
                  linkend="MDM"/> Agent will utilize the mobile device's implementation of the
                selected protocols. HTTPS (FCS_HTTPS_EXT.1) and TLS (FCS_TLSC_EXT.1) are already
                mandatory for a MDF ST. If "TLS" or "DTLS" is selected the following selections from
                the TLS Functional Package must be made: <htm:ul>
                  <htm:li>FCS_TLS_EXT.1: <htm:ul>
                      <htm:li>either TLS or DTLS is selected depending on the selection made in
                        FTP_ITC_EXT.1.1</htm:li>
                      <htm:li>client must be selected</htm:li>
                    </htm:ul>
                  </htm:li>
                  <htm:li>FCS_TLSC_EXT.1.1: <htm:ul>
                      <htm:li>The cipher suites selected must correspond with the algorithms and
                        hash functions allowed in FCS_COP.1 from the MDF PP.</htm:li>
                      <htm:li>mutual authentication must be selected</htm:li>
                    </htm:ul>
                  </htm:li>
                </htm:ul> Protocol, RBG, Certificate validation, algorithm, and similar services may
                be met with platform provided services. <htm:br/><htm:br/>
              </note>
            </f-element>
            <f-element id="mut-chan-init">
              <title><htm:b>Refinement:</htm:b> The <abbr linkend="TSF"/> shall permit the TSF and the <abbr linkend="MDM"/>
                Server and <selectables>
                  <selectable>MAS Server</selectable>
                  <selectable>no other IT entities</selectable>
                </selectables> to initiate communication via the trusted channel.</title>
              <note role="application"> For all other use cases, the mobile device initiates the
                communication; however, for <abbr linkend="MDM"/> Agents, the <abbr linkend="MDM"/>
                Server may also initiate communication.</note>
            </f-element>
            <f-element id="mut-chan-all-none">
              <title><htm:b>Refinement:</htm:b> The TSF shall initiate communication via the trusted channel for all
                communication between the MDM Agent and the MDM Server and <selectables>
                  <selectable>all communication between the MAS Server and the MDM
                    Agent</selectable>
                  <selectable>no other communication</selectable>
                </selectables>
              </title>
              <note role="application"> This element is iterated from the MDF <abbr linkend="PP"/>;
                it is expected that the mobile device will initiate the trusted channel between the MDM
                Agent and the MDM Server for administrative communication and may initiate other
                trusted channels to other trusted IT entities for other uses.</note>
              <aactivity>
                <TSS>The evaluator shall examine the <abbr linkend="TSS"/> to determine that the
                  methods of Agent-Server communication are indicated, along with how those
                  communications are protected. The evaluator shall also confirm that all protocols
                  listed in the <abbr linkend="TSS"/> in support of remote <abbr linkend="TOE"/>
                  administration are consistent with those specified in the requirement, and are
                  included in the requirements in the <abbr linkend="ST"/>.<htm:br/><htm:br/>
                </TSS>
                <Guidance> The evaluator shall confirm that the operational guidance contains
                  instructions for configuring the communication channel between the MDM Agent and
                  the MDM Server and conditionally, the MAS Server for each supported
                  method.<htm:br/><htm:br/>
                </Guidance>
                <Tests>For each supported identifier type (excluding DNs), the evaluator shall
                  repeat the following tests:<htm:br/><htm:br/>
                  <testlist>
                    <test>The evaluators shall ensure that communications using each specified (in
                      the operational guidance) Agent-Server communication method is tested during
                      the course of the evaluation, setting up the connections as described in the
                      operational guidance and ensuring that communication is
                      successful.
                    </test>
                    <test>The evaluator shall ensure, for each method of Agent-Server communication,
                      the channel data is not sent in plaintext.
                    </test>
                    <test>The evaluator shall ensure, for each communication channel with the MDM
                      Server, that a protocol analyzer identifies the traffic as the protocol under
                      testing.
                    </test>
                  </testlist> 
                    <htm:br/>
                    Further evaluation activities are associated with the specific protocols.<htm:br/><htm:br/>
                </Tests>
              </aactivity>
            </f-element>
          </f-component>
          <f-component cc-id="ftp_trp.1" name="Trusted Path (for Enrollment)" iteration="TRUSTPATH">
            <consistency-rationale>This SFR uses the trusted channel protocols defined by the <abbr
                linkend="Base-PP"/> in FTP_ITC_EXT.1 to facilitate a trusted path that the <abbr
                linkend="MDM"/> Agent can use to enroll the mobile device it runs on into
              management. Even though the <abbr linkend="Base-PP"/> does not define FTP_TRP.1, the
              requirement was given an iteration label for consistency with the <abbr linkend="MDM"
              /> Server requirement of the same name. </consistency-rationale>
            <f-element>
              <title><htm:b>Refinement:</htm:b> The TSF shall use <selectables linebreak="yes">
                  <selectable id="TRP_TLS_2">TLS client as defined in the Package for Transport Layer Security</selectable>
                  <selectable id="TRP_HTTPS_2">HTTPS</selectable>
                </selectables> to provide a trusted communication path between itself and another
                trusted IT product that is logically distinct from other communication paths and
                provides assured identification of its endpoints and protection of the communicated
                data from disclosure and detection of modification of the communicated data from
                [<htm:i>modification, disclosure</htm:i>]. </title>
            </f-element>
            <f-element>
              <title><htm:b>Refinement:</htm:b> The TSF shall permit MD users to initiate communication via the trusted path.
              </title>
            </f-element>
            <f-element>
              <title><htm:b>Refinement:</htm:b> The TSF shall require the use of the trusted path for [<htm:i>[all MD user actions]</htm:i>]. 
              </title>
              <note role="application"> This requirement ensures that authorized MD users initiate
                all communication with the <abbr linkend="TOE"/> via a trusted path, and that all
                communications with the <abbr linkend="TOE"/> by MD users is performed over this
                path. The purpose of this connection is for enrollment by the MD user.
                <htm:br/><htm:br/> The <abbr linkend="ST"/> author chooses the mechanism or
                mechanisms supported by the <abbr linkend="TOE"/>. The data passed in this trusted
                communication channel are encrypted as defined by the protocol selected.
                <htm:br/><htm:br/> Since this requirement is only for the case when the <abbr
                  linkend="PP-Module"/> builds on MDF PP and in this case it is expected that the
                  <abbr linkend="MDM"/> Agent will be a native part of the mobile operating system,
                it is expected that the <abbr linkend="MDM"/> Agent will utilize the mobile device's
                implementation of the selected protocols. HTTPS (FCS_HTTPS_EXT.1) and TLS
                (FCS_TLSC_EXT.1) are already mandatory for a MDF ST. If "TLS" or "DTLS" is selected
                the following selections from the TLS Functional Package must be made: <!-- TODO: What is their implementation of HTTPS evaluated against?? -->
                <!--  If "implement functionality to use HTTPS" is selected-->
                <htm:ul>
                  <htm:li>FCS_TLS_EXT.1: <htm:ul>
                      <htm:li>TLS must be selected</htm:li>
                      <htm:li>client must be selected</htm:li>
                    </htm:ul>
                  </htm:li>
                  <htm:li>FCS_TLSC_EXT.1.1: <htm:ul>
                      <htm:li>The cipher suites selected must correspond with the algorithms and
                        hash functions allowed in FCS_COP.1 from the MDF PP.</htm:li>
                    </htm:ul>
                  </htm:li>
                </htm:ul>
              </note>
              <aactivity>
                <TSS>The evaluator shall examine the <abbr linkend="TSS"/> to determine that the
                  methods of remote enrollment are indicated, along with how those communications
                  are protected. The evaluator shall also confirm that all protocols listed in the
                    <abbr linkend="TSS"/> in support of enrollment are consistent with those
                  specified in the requirement, and are included in the requirements in the <abbr
                    linkend="ST"/>.<htm:br/><htm:br/>
                </TSS>
                <Guidance>The evaluator shall confirm that the operational guidance contains
                  instructions for establishing the enrollment sessions for each supported
                  method.<htm:br/><htm:br/>
                </Guidance>
                <Tests>For each <abbr linkend="MDM"/> Agent/platform listed as supported in the
                    <abbr linkend="ST"/>: <htm:br/><htm:br/>
                  <testlist>
                    <test>The evaluators shall ensure that communications using each specified (in
                      the operational guidance) enrollment method is tested during the course of the
                      evaluation, setting up the connections as described in the operational
                      guidance and ensuring that communication is successful.
                    </test>
                    <test>For each method of enrollment supported, the evaluator shall follow the
                      operational guidance to ensure that there is no available interface that can
                      be used by a remote user to establish enrollment sessions without invoking the
                      trusted path.
                    </test>
                    <test>The evaluator shall ensure, for each method enrollment, the channel data
                      is not sent in plaintext.
                    </test>
                  </testlist> 
                    <htm:br/>
                    Further evaluation activities are associated with the specific protocols.<htm:br/><htm:br/>
                </Tests>
              </aactivity>
            </f-element>
          </f-component>
        </subsection>
      </additional-sfrs>
      <con-toe> When this <abbr linkend="PP-Module"/> is used to extend the MDF PP, the TOE type for
        the overall TOE is still a mobile device. The TOE boundary is simply extended to include the
          <abbr linkend="MDM"/> Agent application that runs on the mobile device.</con-toe>
      <con-sec-prob/>
      <con-obj/>
      <con-op-en/>
      <con-mod id="T.BACKUP"> This threat protects user data from unauthorized logical access. An
        attacker would attempt to exploit this threat by first exploiting the T.PHYSICAL, T.FLAWAPP,
        or T.PERSISTENT threats defined in the <abbr linkend="Base-PP"/> against the mobile device
        as a whole, and then using the device itself as an attack vector against any backup data
        stored on the TOE.</con-mod>
      <con-mod id="O.ACCOUNTABILITY"> The <abbr linkend="Base-PP"/> provides an objective,
        O.INTEGRITY, that ensures that the integrity of the mobile device is maintained. This
        objective assists in the implementation of O.INTEGRITY by providing records of
        administrative activity, which would include actions that could cause the integrity of the
        mobile device to be lost.</con-mod>
      <con-mod id="O.APPLY_POLICY"> This objective supports the implementation of the O.CONFIG
        objective defined in the <abbr linkend="Base-PP"/> by specifying an additional method by
        which the TSF may be configured.</con-mod>
      <con-mod id="O.DATA_PROTECTION_TRANSIT"> This objective extends the <abbr linkend="Base-PP"
        />’s O.COMMS objective by ensuring that the communications related to <abbr linkend="MDM"/>
        Agent functionality are secured in the same manner as other sensitive data transmitted
        to/from the mobile device.</con-mod>
      <con-mod id="O.STORAGE"> This objective extends the <abbr linkend="Base-PP"/>’s O.STORAGE
        objective by ensuring that the mobile device’s data-at-rest protection mechanisms can also
        be used to secure the <abbr linkend="MDM"/> Agent and related data.</con-mod>
      <con-mod id="OE.DATA_PROPER_ADMIN"> This objective extends the <abbr linkend="Base-PP"/>’s
        OE.CONFIG objective by expecting that TOE administrators act appropriately when installing
        or configuring the <abbr linkend="MDM"/> Agent.</con-mod>
      <con-mod id="OE.DATA_PROPER_USER"> This objective extends the <abbr linkend="Base-PP"/>’s
        OE.NOTIFY and OE.PRECAUTION objectives by setting reasonable expectations for user security
        behavior.</con-mod>
      <con-mod id="OE.IT_ENTERPRISE"> This objective helps mitigate the T.EAVESDROP and T.NETWORK
        threats defined by the <abbr linkend="Base-PP"/> by reducing the network exposure of the
        mobile device. This does not conflict with the <abbr linkend="Base-PP"/> because the <abbr
          linkend="Base-PP"/> does not set specific expectations for the level of security that the
        enterprise provides, but all use cases from the <abbr linkend="Base-PP"/> set expectations
        that the mobile device is used for some enterprise purposes so it is reasonable to expect
        the enterprise have security controls in place to protect these functions. </con-mod>
      <con-mod id="OE.MOBILE_DEVICE_PLATFORM"> This objective is suitable because the <abbr
          linkend="MDM"/> Agent can reasonably expect the device it has been deployed on to be
        secure.</con-mod>
      <con-mod id="OE.WIRELESS_NETWORK"> This objective is suitable because while the <abbr
          linkend="Base-PP"/> does not associate any availability metrics with wireless
        communications, the mobile device will always provide the ability to access a wireless
        network.</con-mod>
      <con-mod id="fau_alt_ext.2"> This SFR requires the <abbr linkend="MDM"/> Agent to use a
        trusted channel defined by FTP_ITC_EXT.1 in the <abbr linkend="Base-PP"/> to transmit data
        about its own behavior to the Operational Environment.</con-mod>
      <con-mod id="fau_gen.1(2)"> The <abbr linkend="Base-PP"/> defines FAU_GEN.1; this <abbr
          linkend="PP-Module"/> defines a second iteration to use the same audit mechanism to
        generate audit records for the <abbr linkend="MDM"/> Agent’s behavior. It may alternatively
        allow the TSF to generate its own audit trail, which does not impede the MDF from enforcing
        its own security functionality.</con-mod>
      <con-mod id="fau_sel.1(2)"> The <abbr linkend="Base-PP"/> defines FAU_SEL.1; this <abbr
          linkend="PP-Module"/> defines a second iteration to use the same audit mechanism to select
        the auditable events to be generated by the <abbr linkend="MDM"/> Agent. Note that the <abbr
          linkend="Base-PP"/> does not mandate this requirement so it is possible that only the
          <abbr linkend="MDM"/> Agent portion of the TOE may implement it. In this case, the SFR
        provides a selection for the <abbr linkend="MDM"/> Agent to implement its own mechanism to
        perform this function rather than a platform-provided one.</con-mod>
      <con-mod id="fia_enr_ext.2"> This SFR requires the <abbr linkend="MDM"/> Agent to record data
        that it receives from the Operational Environment. It does not need to use any functionality
        defined in the <abbr linkend="Base-PP"/> to do this, and doing this does not prevent the
        enforcement of any security requirements from the <abbr linkend="Base-PP"/>. </con-mod>
      <con-mod id="fmt_pol_ext.2"> This SFR requires the <abbr linkend="MDM"/> Agent to use a
        digital signature algorithm to validate data that it receives from the Operational
        Environment. To do this, the <abbr linkend="MDM"/> Agent will use the functionality defined
        by the <abbr linkend="Base-PP"/> in FCS_COP.1(3).</con-mod>
      <con-mod id="fmt_smf_ext.4"> This SFR defines the ability of the <abbr linkend="MDM"/> Agent
        to interact with the mobile device to execute the management functions defined by
        FMT_MOF_EXT.1 in the <abbr linkend="Base-PP"/>. The <abbr linkend="Base-PP"/> specifically
        indicates in FMT_MOF_EXT.1.2 that some management functions may be performed via
        MDM.</con-mod>
      <con-mod id="fmt_unr_ext.1"> This SFR defines the functions performed by the <abbr
          linkend="MDM"/> Agent when unenrolled from an <abbr linkend="MDM"/>. The <abbr
          linkend="Base-PP"/> defines unenrollment actions in FMT_SMF_EXT.2, and goes on to note
        that these actions may be performed “perhaps via an <abbr linkend="MDM"/> agent,” so this is
        expected behavior. </con-mod>
      <con-mod id="fau_stg_ext.3"> This SFR defines the ability of the <abbr linkend="MDM"/> Agent
        to store generated audit data in the audit storage provided by the mobile device. The <abbr
          linkend="Base-PP"/> defines the capability for audit storage in FAU_STG.1.</con-mod>
      <con-mod id="fpt_net_ext.1"> This SFR defines the ability of the <abbr linkend="MDM"/> Agent
        to maintain information about its last successful connection with the environmental <abbr
          linkend="MDM"/> Server (i.e., the last successful invocation of the trusted channel for
        that interface, as defined in FTP_ITC_EXT.1 of the <abbr linkend="Base-PP"/>). It does not
        need to use any functionality defined in the <abbr linkend="Base-PP"/> to do this, and doing
        this does not prevent the enforcement of any security requirements from the <abbr
          linkend="Base-PP"/>.</con-mod>
    </base-pp>
    <base-pp version="4.0" name="Mobile Device Management" product="MDM Server" short="MDM"
      url="https://www.niap-ccevs.org/Profile/Info.cfm?PPID=392&amp;id=392"
      xmlurl="https://raw.githubusercontent.com/commoncriteria/mdm/master/input/mdm.xml">
      <!--   <app-unmod-sfrs> 
        The SFRs listed in this section are defined in the MDM PP and relevant to the secure operation of the MDM Agent. While testing the TOE, it is necessary to ensure these SFRs are tested specifically in conjunction with the MDM Agent portion of the TOE. The ST author may complete all selections and assignments in these SFRs without any additional restrictions.
        <htm:ul>
          <htm:li>FCS_CKM.1</htm:li>
          <htm:li>FCS_CKM.2</htm:li>
          <htm:li>FCS_CKM_EXT.4</htm:li>
          <htm:li>FCS_COP.1(*)</htm:li>
          <htm:li>FCS_RBG_EXT.1</htm:li>
          <htm:li>FIA_X509_EXT.1</htm:li>
          <htm:li>FIA_X509_EXT.2</htm:li>
          <htm:li>FIA_X509_EXT.3</htm:li>
          <htm:li>FIA_X509_EXT.4</htm:li>
          <htm:li>FCS_DTLS_EXT.1</htm:li>
          <htm:li>FCS_HTTPS_EXT.1</htm:li>
        </htm:ul>
      </app-unmod-sfrs>-->
      <modified-sfrs/>
      <additional-sfrs>
        <subsection id="mdm-crypto-fcs" title="Cryptographic Support (FCS)">
          <f-component cc-id="fcs_stg_ext.1" name="Cryptographic Key Storage" iteration="KEYSTO">
            <!-- Removed notnew=y from f-component -->
            <consistency-rationale> The <abbr linkend="Base-PP"/> requires the TOE to define a
              method of key storage. This <abbr linkend="PP-Module"/> iterates it to specify the use
              of platform key storage for <abbr linkend="MDM"/> Agents. </consistency-rationale>
            <f-element>
              <title><htm:b>Refinement:</htm:b> The MDM Agent shall use the [<htm:i>platform-provided key storage</htm:i>] for all persistent
                secret and private keys.</title>
              <note role="application"> This requirement ensures that persistent secrets
                (credentials, secret keys) and private keys are stored securely when not in use by
                the mobile platform.<htm:br/><htm:br/>
              </note>
              <aactivity>
                <TSS> The evaluator will verify that the <abbr linkend="TSS"/> lists each persistent
                  secret (credential, secret key) and private key needed to meet the requirements in
                  the <abbr linkend="ST"/>. For each of these items, the evaluator will confirm that
                  the <abbr linkend="TSS"/> lists for what purpose it is used, and, for each
                  platform listed as supported in the <abbr linkend="ST"/>, how it is stored. The
                  evaluator shall verify that the Agent calls a platform-provided API to store
                  persistent secrets and private keys.<htm:br/><htm:br/>
                </TSS>
              </aactivity>
            </f-element>
          </f-component>
        </subsection>
<!--        <subsection id="fpt" title="Protection of the TSF (FPT)">
          <f-component name="Internal TOE TSF Data Transfer" id="FPT_ITT.1(2)">
            <consistency-rationale>The <abbr linkend="Base-PP"/> defines this SFR for secure data
              transfer between distributed TOE components. This <abbr linkend="PP-Module"/> makes
              this functionality mandatory (since the TOE will include both the <abbr linkend="MDM"
              /> Server and distributed <abbr linkend="MDM"/> Agents) and also eliminates IPsec as a
              supported protocol since commercially-available <abbr linkend="MDM"/> Agents do not
              use this to communicate with <abbr linkend="MDM"/> Servers. </consistency-rationale>
            <f-element id="FPT_ITT.1.1(2)">
              <title><htm:b>Refinement:</htm:b> The TSF shall <selectables>
                  <selectable>invoke platform-provided functionality to use <selectables
                      linebreak="yes">
                      <selectable>mutually authenticated TLS</selectable>
                      <selectable>HTTPS</selectable>
                      <selectable>mutually authenticated DTLS</selectable>
                    </selectables>
                  </selectable>
                  <selectable>implement functionality to use <selectables linebreak="yes">
                      <selectable>mutually authenticated TLS as defined in the Package for Transport
                        Layer Security</selectable>
                      <selectable>HTTPS</selectable>
                      <selectable>mutually authenticated DTLS as defined in the Package for
                        Transport Layer Security</selectable>
                    </selectables></selectable>
                </selectables> to protect all data from [<htm:i>disclosure, modification</htm:i>] when it is
                transferred between separate parts of the TOE. </title>
              <note role="application"> The intent of this requirement is to protect the
                communications channel between <abbr linkend="MDM"/> Server and Agent, post
                enrollment. <linkref linkend="FTP_TRP.1(2)"/> from the <abbr linkend="Base-PP"/> is
                to protect the communications channel between <abbr linkend="MDM"/> Server and Agent
                during enrollment. <htm:br/><htm:br/> This requirement is to ensure that the
                transmission of any audit logs, mobile device information data (software version,
                hardware model, and application versions), and configuration data collected by the
                  <abbr linkend="MDM"/> Agent and sent from the <abbr linkend="MDM"/> Agent to the
                  <abbr linkend="MDM"/> Server, when commanded, or at configurable intervals, is
                properly protected. This trusted channel also protects any commands and policies
                sent by the <abbr linkend="MDM"/> Server to the <abbr linkend="MDM"/> Agent. Either
                the <abbr linkend="MDM"/> Agent or the <abbr linkend="MDM"/> Server is able to
                initiate the connection.<htm:br/><htm:br/> This requirement is iterated from the
                  <abbr linkend="Base-PP"/> to indicate the protocols that the MDM agent can use for
                a trusted channel. Since this requirement is only for the case when the <abbr
                  linkend="PP-Module"/> builds on <abbr linkend="MDM"/> PP and in this case it is
                expected that the <abbr linkend="MDM"/> Agent will be a third party application
                provided by the <abbr linkend="MDM"/> Server, it is acceptable for the <abbr
                  linkend="MDM"/> Agent to utilize the protocol implementations from the mobile
                device. If that is the case then "invoke platform-provided functionality" must be
                selected. If the <abbr linkend="MDM"/> agent implements the protocol itself, then
                "implement functionality" must be selected.<htm:br/><htm:br/> If "HTTPS" is selected
                the appropriate selection-based SFRs from <appref linkend="sel-based"/> of <abbr
                  linkend="MDM"/> PP must be included in the ST, if not already
                present.<htm:br/><htm:br/> If "implement functionality to use mutually authenticated
                TLS as defined in the Package for Transport Layer Security" or "implement
                functionality to use mutually authenticated DTLS as defined in the Package for
                Transport Layer Security" is selected the TLS Functional Package must be included in
                the <abbr linkend="ST"/>, with the following selections made: <htm:ul>
                  <htm:li>FCS_TLS_EXT.1: <htm:ul>
                      <htm:li>either TLS or DTLS is selected depending on the selection made in
                        FPT_ITT.1.1</htm:li>
                      <htm:li>either client or server is selected as appropriate</htm:li>
                    </htm:ul>
                  </htm:li>
                  <htm:li>FCS_TLSC_EXT.1.1 or FCS_TLSS_EXT.1.1 (as appropriate): <htm:ul>
                      <htm:li>The cipher suites selected must correspond with the algorithms and
                        hash functions allowed in FCS_COP.1 from the MDM PP.</htm:li>
                      <htm:li>mutual authentication must be selected</htm:li>
                    </htm:ul>
                  </htm:li>
                </htm:ul> Protocol, RBG, Certificate validation, algorithm, and similar services may
                be met with platform provided services. <htm:br/><htm:br/>
              </note>
              <aactivity>
                <TSS>The evaluator shall examine the <abbr linkend="TSS"/> to determine that the
                  methods and protocols used to protect distributed <abbr linkend="TOE"/> components
                  are described. The evaluator shall also confirm that all protocols listed in the
                    <abbr linkend="TSS"/> in support of <abbr linkend="TOE"/> administration are
                  consistent with those specified in the requirement, and are included in the
                  requirements in the <abbr linkend="ST"/>.<htm:br/><htm:br/> If "invoke
                  platform-provided functionality" is selected, the evaluator shall examine the
                    <abbr linkend="TSS"/> of the <abbr linkend="MDM"/> Server's <abbr linkend="ST"/>
                  to verify that it describes (for each supported platform) how this functionality
                  is invoked (it should be noted that this may be through a mechanism that is not
                  implemented by the <abbr linkend="MDM"/> Server; nonetheless, that mechanism will
                  be identified in the <abbr linkend="TSS"/> as part of this evaluation
                  activity).<htm:br/><htm:br/>
                </TSS>
                <Guidance>The evaluator shall confirm that the operational guidance contains
                  instructions for establishing the communication paths for each supported
                  method.<htm:br/><htm:br/>
                </Guidance>
                <Tests>
                  <testlist>
                    <test>The evaluators shall ensure that communications using each specified (in
                      the operational guidance) communication method is tested during the course of
                      the evaluation, setting up the connections as described in the operational
                      guidance and ensuring that communication is successful.
                    </test>
                    <test>The evaluator shall ensure, for each method of communication, the channel
                      data is not sent in plaintext.
                    </test>
                  </testlist> 
                    <htm:br/>
                    Further evaluation activities are associated with the specific protocols.<htm:br/><htm:br/>
                </Tests>
              </aactivity>
            </f-element>
          </f-component>
       </subsection>
-->
      </additional-sfrs>
      <con-toe> When this <abbr linkend="PP-Module"/> is used to extend the <abbr linkend="MDM"/>
        PP, the TOE type for the overall TOE is still mobile device management. The TOE boundary is
        simply extended to include the <abbr linkend="MDM"/> Agent(s) that reside on individual
        mobile devices and support the management functionality that the <abbr linkend="MDM"/>
        Server component implements.</con-toe>
      <con-sec-prob/>
      <con-obj/>
      <con-op-en/>
      <con-mod id="T.BACKUP"> This threat protects user data from unauthorized logical access. If
        the backup data is stored outside the MDM or the mobile device that it protects, then there
        is no conflict with the MDM PP since it is a different security boundary. If the backup data
        is stored either on the MDM or on the protected device, an attacker would attempt to exploit
        this threat by first exploiting any of the threats that the MDM PP defines
        (T.MALICIOUS_APPS, T.NETWORK_ATTACK, T.NETWORK_EAVESDROP, T.PHYSICAL_ACCESS) depending on
        where and how the backup data is stored, and then use successful exploitation of one of
        these threats to attempt to access the backup data itself.</con-mod>
      <con-mod id="O.ACCOUNTABILITY"> The MDM PP contains this same objective with the same
        purpose.</con-mod>
      <con-mod id="O.APPLY_POLICY"> The MDM PP contains this same objective with the same purpose. </con-mod>
      <con-mod id="O.DATA_PROTECTION_TRANSIT"> The MDM PP contains this same objective with the same
        purpose. </con-mod>
      <con-mod id="O.STORAGE"> This objective requires the MDM Agent to use platform key storage to
        protect secret and private key data. The MDM PP defines a requirement for key storage
        (FCS_STG_EXT.1) that allows the MDM Agent to satisfy this objective. </con-mod>
      <con-mod id="OE.DATA_PROPER_ADMIN"> The MDM PP contains this same objective with the same
        purpose. </con-mod>
      <con-mod id="OE.DATA_PROPER_USER"> The MDM PP contains this same objective with the same
        purpose. </con-mod>
      <con-mod id="OE.IT_ENTERPRISE"> The MDM PP contains this same objective with the same purpose. </con-mod>
      <con-mod id="OE.MOBILE_DEVICE_PLATFORM"> The MDM PP contains this same objective with the same
        purpose. </con-mod>
      <con-mod id="OE.WIRELESS_NETWORK"> The MDM PP contains this same objective with the same
        purpose. </con-mod>
      <con-mod id="fau_alt_ext.2"> This SFR provides the alerts that are received by the <abbr
          linkend="MDM"/> Server as per FAU_ALT_EXT.1 in the <abbr linkend="Base-PP"/>.</con-mod>
      <con-mod id="fau_gen.1(2)"> This SFR requires the MDM Agent to generate audit records of its
        behavior. The mechanism by which it does this is not relevant to the MDM Server portion of
        the TOE as they reside on different platforms.</con-mod>
      <con-mod id="fau_sel.1(2)"> The <abbr linkend="Base-PP"/> defines FAU_SEL.1 as an optional SFR
        to limit the audit events that are generated by the TSF. This <abbr linkend="PP-Module"/>
        adds another iteration that requires the <abbr linkend="MDM"/> Agent to include this
        capability by default.</con-mod>
      <con-mod id="fia_enr_ext.2"> This SFR provides information during agent enrollment that is
        required by the <abbr linkend="MDM"/> Server to meet the FIA_ENR_EXT.1 requirement defined
        by the <abbr linkend="Base-PP"/>.</con-mod>
      <con-mod id="fmt_pol_ext.2"> The <abbr linkend="Base-PP"/> defines an SFR (FMT_POL_EXT.1) that
        requires the <abbr linkend="MDM"/> Server to provide digitally signed policies and policy
        updates to the <abbr linkend="MDM"/> Agent. FMT_POL_EXT.2 completes this transaction by
        requiring the <abbr linkend="MDM"/> Agent to accept only signed policies and policy
        updates.</con-mod>
      <con-mod id="fmt_smf_ext.4"> This SFR requires the <abbr linkend="MDM"/> Agent to interact
        with the underlying mobile device platform to enforce management functions that are
        configured by the <abbr linkend="MDM"/> Server (FMT_SMF.1(1) in the <abbr linkend="Base-PP"
        />).</con-mod>
      <con-mod id="fmt_unr_ext.1"> This SFR requires the TSF to define its behavior upon
        unenrollment from management. Unenrollment from management is a management function that is
        specified in the <abbr linkend="Base-PP"/>.</con-mod>
      <con-mod id="fau_stg_ext.3"> This SFR defines the ability of the <abbr linkend="MDM"/> Agent
        to store generated audit data in the audit storage provided by the mobile device. This does
        not impact the <abbr linkend="Base-PP"/> since it resides on a different platform from the
          <abbr linkend="MDM"/> Agent. </con-mod>
      <con-mod id="fpt_net_ext.1"> This SFR defines the ability of the <abbr linkend="MDM"/> Agent
        to maintain information about its last successful connection with the environmental <abbr
          linkend="MDM"/> Server (i.e., the last successful invocation of the trusted channel for
        that interface, as defined in FPT_ITT.1(2) of the <abbr linkend="Base-PP"/>). It does not
        otherwise impact the <abbr linkend="Base-PP"/> since it describes behavior that occurs local
        to the <abbr linkend="MDM"/> Agent during a period where it is not interacting with the
          <abbr linkend="MDM"/> Server. </con-mod>
    </base-pp>
    <man-sfrs>
      <subsection id="fau" title="Security Audit (FAU)">
        <ext-comp-def fam-id="FAU_ALT_EXT" title="MDM Alerts">
          <mod-def> This family is defined in the <abbr linkend="MDM"/>
            <abbr linkend="Base-PP"/>. This <abbr linkend="PP-Module"/> augments the extended family
            by adding one additional component, FAU_ALT_EXT.2. This new component and its impact on
            the extended family’s component leveling are shown below; reference the <abbr
              linkend="MDM"/> PP for all other definitions for this family. </mod-def>
        </ext-comp-def>
        <f-component cc-id="fau_alt_ext.2" name="Agent Alerts">
          <consistency-rationale/>
          <comp-lev>requires the TSF to define when and how an <abbr linkend="MDM"/> Agent generates
            alerts and transmits them to an <abbr linkend="MDM"/> Server based on its
            activity.</comp-lev>
          <management>The following actions could be considered for the management functions in FMT: <htm:ul>
              <htm:li>Ability to configure the specific events that result in generation of
                alerts.</htm:li>
            </htm:ul>
          </management>
          <audit> The following actions should be auditable if FAU_GEN Security audit data
            generation is included in the PP/ST:<htm:ul>
              <htm:li>Minimal: Success/failure of sending alert. </htm:li>
            </htm:ul>
          </audit>
          <dependencies> FAU_ALT_EXT.1 Server Alerts<htm:br/> [FPT_ITT.1(2) Basic Internal TSF Data
            Transfer Protection; or<htm:br/> FTP_ITC.1 Inter-TSF Trusted Channel] </dependencies>
          <f-element>
            <title>The <abbr linkend="MDM"/> Agent shall provide an alert via the trusted channel to
              the <abbr linkend="MDM"/> Server in the event of any of the following audit events: <htm:ul>
                <htm:li>successful application of policies to a mobile device,</htm:li>
                <htm:li>
                  <selectables>
                    <selectable>receiving</selectable>
                    <selectable>generating</selectable>
                  </selectables> periodic reachability events, </htm:li>
                <htm:li><selectables linebreak="yes">
                  <selectable>change in enrollment state</selectable>
                  <selectable>failure to install an application from the MAS Server</selectable>
                  <selectable>failure to update an application from the MAS Server</selectable>
                  <selectable><assignable>other events</assignable></selectable>
                  <selectable>no other events</selectable>
                </selectables>.</htm:li>
              </htm:ul>
            </title>
            <note role="application"> The trusted channel is defined in FPT_ITT.1(2) of the <abbr linkend="Base-PP"/> if Agent extends <abbr linkend="MDM"/> Server and FTP_ITC_EXT.1 if Agent extends MDF <abbr
                linkend="PP"/>. “Alert” in this requirement could be as simple as an audit record or
              a notification. If any prior alerts exist in the queue, per FAU_ALT_EXT.2.2, those
              alerts must be sent when the trusted channel is available.<htm:br/><htm:br/> This
              requirement is to ensure that the <abbr linkend="MDM"/> Agent must notify the <abbr
                linkend="MDM"/> Server whenever one of the events listed above occurs. Lack of
              receipt of a successful policy installation indicates the failure of the policy
              installation.<htm:br/><htm:br/> The periodic reachability events ensure that either
              the <abbr linkend="MDM"/> Agent responds to <abbr linkend="MDM"/> Server polls to
              determine device network reachability, or the <abbr linkend="MDM"/> Agent can be
              configured to regularly notify the Server that it is reachable. The <abbr linkend="ST"
              /> author must select “receiving” in the first case and “generating” in the second.
              The corresponding requirement for the <abbr linkend="MDM"/> Server is FAU_NET_EXT.1 in
              the <abbr linkend="MDM"/>
              <abbr linkend="PP"/>.<htm:br/><htm:br/> The <abbr linkend="ST"/> author must either
              assign further events or select the “no other events” option. Note that alerts may
              take time to reach the <abbr linkend="MDM"/> Server, or not arrive, due to poor
              connectivity. <htm:br/><htm:br/>
            </note>            
          </f-element>
          <f-element>
            <title>The MDM Agent shall queue alerts if the trusted channel is not available.</title>
            <note role="application">If the trusted channel is not available, alerts must be queued. When the trusted channel becomes available, the queued alerts must be sent.<htm:br/><htm:br/>
            </note>
            <aactivity>
              <TSS>                  
                  The evaluator shall examine the <abbr linkend="TSS"/> and verify that it describes how the alerts are implemented.<htm:br/><htm:br/> 
                  The evaluator shall examine the <abbr linkend="TSS"/> and verify that it describes how the candidate policy updates are obtained and the actions that take place for successful (policy update installed) and unsuccessful (policy update not installed) cases. The software components that are performing the processing must also be identified in the <abbr linkend="TSS"/> and verified by the evaluator.<htm:br/><htm:br/> 
                  The evaluator also ensures that the <abbr linkend="TSS"/> describes how reachability events are implemented, and if configurable are selected in FMT_SMF_EXT.4.2. The evaluator verifies that this description clearly indicates who (<abbr linkend="MDM"/> Agent or <abbr linkend="MDM"/> Server) initiates reachability events.<htm:br/><htm:br/> 
                  The evaluator shall ensure that the <abbr linkend="TSS"/> describes under what circumstances, if any, the alert may not be generated (e.g., the device is powered off or disconnected from the trusted channel), how alerts are queued, and the maximum amount of storage for queued messages.<htm:br/><htm:br/>
              </TSS>
              <Tests>
                  <testlist>
                      <test>The evaluator shall perform a policy update from the test environment <abbr linkend="MDM"/> server. The evaluator shall verify the <abbr linkend="MDM"/> Agent accepts the update, makes the configured changes, and reports the success of the policy update back to the <abbr linkend="MDM"/> Server.</test>
                      <test>The evaluator shall perform each of the actions listed in FAU_ALT_EXT.2.1 and verify that the alert does in fact reach the <abbr linkend="MDM"/> Server.</test>
                      <test>The evaluator shall configure the <abbr linkend="MDM"/> Agent to perform a network reachability test, both with and without such connectivity and ensure that results reflect each.</test>
                      <test>The evaluator shall remove network connectivity from the MDM Agent and generate an alert/event as defined in FAU_ALT_EXT.2.1. The evaluator shall restore network connectivity to the MDM Agent and verify that the alert generated while the <abbr linkend="TOE"/> was disconnected is sent by the MDM Agent upon re-establishment of the connectivity.</test>
                  </testlist>
              </Tests>
            </aactivity>
          </f-element>
        </f-component>
        <f-component cc-id="fau_gen.1" name="Audit Data Generation" iteration="AUDITGEN">
          <consistency-rationale/>
          <f-element>
            <title><htm:b>Refinement:</htm:b> The <abbr linkend="MDM"/> Agent shall <selectables>
                <selectable>invoke platform-provided functionality</selectable>
                <selectable>implement functionality</selectable>
              </selectables> to generate an <abbr linkend="MDM"/> Agent audit record of the
              following auditable events: <htm:ol type="a">
                <htm:li>Startup and shutdown of the <abbr linkend="MDM"/> Agent;</htm:li>
                <htm:li>All auditable events for [<htm:i>not specified</htm:i>] level of audit; and</htm:li>
                <htm:li>[<htm:i><abbr linkend="MDM"/> policy updated, any modification commanded by the 
                  <abbr linkend="MDM"/> Server, specifically defined auditable events listed in 
                  <ctr-ref ref-id="audit"/>, and <selectables>
                  <selectable><assignable>other events</assignable></selectable>
                  <selectable>no other events</selectable>
                </selectables></htm:i>].</htm:li>
              </htm:ol>
            </title>
            <note role="application"> This requirement outlines the information to be included in
              the <abbr linkend="MDM"/> Agent’s audit records. The <abbr linkend="ST"/> author can
              include other auditable events directly in the Auditable Events table in
              FAU_GEN.1.1(2); they are not limited to the list presented.<htm:br/><htm:br/>
              <abbr linkend="MDM"/> policy update must minimally indicate that an update to policy
              occurred. The event record need not contain the differences between the prior policy
              and the new policy; optionally, the specific change(s) to policy that were included in
              that update may be detailed. All updates to policy should trigger this alert.
              Modifications commanded by the <abbr linkend="MDM"/> Server are those commands listed
              in FMT_SMF.1.1.<htm:br/><htm:br/> The selection for the FMT_UNR_EXT.1 auditable event
              in the Auditable Events table corresponds to the selection in FMT_UNR_EXT.1. If “apply
              remediation actions” is selected in FMT_UNR_EXT.1, then the <abbr linkend="ST"/>
              author selects “attempt to unenroll” in FAU_GEN.1.1(2) Auditable Events table for
              FMT_UNR_EXT.1; otherwise, "none" is selected.<htm:br/><htm:br/>
              <htm:b><ctr id="audit" ctr-type="Table"> Auditable Events</ctr></htm:b>
              <htm:table style="margin-top:0px;white-space:10px">
                <htm:TR>
                  <htm:TH>Requirement</htm:TH>
                  <htm:TH>Auditable Events</htm:TH>
                  <htm:TH>Additional Audit Record Contents</htm:TH>
                </htm:TR>
                <htm:TR>
                  <htm:TD>FAU_ALT_EXT.2</htm:TD>
                  <htm:TD>Success/failure of sending alert.</htm:TD>
                  <htm:TD>No additional information.</htm:TD>
                </htm:TR>
                <htm:TR>
                  <htm:TD>FAU_GEN.1</htm:TD>
                  <htm:TD>None.</htm:TD>
                  <htm:TD>N/A</htm:TD>
                </htm:TR>
                <htm:TR>
                  <htm:TD>FAU_SEL.1</htm:TD>
                  <htm:TD>All modifications to the audit configuration that occur while the audit
                    collection functions are operating.</htm:TD>
                  <htm:TD>No additional information.</htm:TD>
                </htm:TR>
                <htm:TR>
                  <htm:TD>FCS_STG_EXT.4/<htm:br/> FCS_STG_EXT.1(2)</htm:TD>
                  <htm:TD>None.</htm:TD>
                  <htm:TD/>
                </htm:TR>
                <htm:TR>
                  <htm:TD rowspan="3">FCS_TLSC_EXT.1</htm:TD>
                  <htm:TD>Failure to establish a TLS session.</htm:TD><htm:TD>Reason for failure.</htm:TD></htm:TR>
                <htm:TR><htm:TD>Failure to verify presented identifier.</htm:TD><htm:TD>Presented identifier and reference identifier.</htm:TD></htm:TR>
                <htm:TR><htm:TD>Establishment/termination of a TLS session.</htm:TD><htm:TD>Non-TOE endpoint of connection.</htm:TD>
                </htm:TR>
                <htm:TR>
                  <htm:TD>FIA_ENR_EXT.2</htm:TD>
                  <htm:TD>Enrollment in management.</htm:TD>
                  <htm:TD>Reference identifier of <abbr linkend="MDM"/> Server.</htm:TD>
                </htm:TR>
                <htm:TR>
                  <htm:TD>FMT_POL_EXT.2</htm:TD>
                  <htm:TD>Failure of policy validation.</htm:TD>
                  <htm:TD>Reason for failure of validation.</htm:TD>
                </htm:TR>
                <htm:TR>
                  <htm:TD>FMT_SMF_EXT.4</htm:TD>
                  <htm:TD>Outcome (Success/failure) of function.</htm:TD>
                  <htm:TD>No additional information.</htm:TD>
                </htm:TR>
                <htm:TR>
                  <htm:TD>FMT_UNR_EXT.1.1</htm:TD>
                  <htm:TD>
                    <selectables>
                      <selectable>Attempt to unenroll</selectable>
                      <selectable>none</selectable>
                    </selectables>
                  </htm:TD>
                  <htm:TD>No additional information.</htm:TD>
                </htm:TR>
                <htm:TR>
                  <htm:TD>FTP_ITC_EXT.1(2)</htm:TD>
                  <htm:TD>Initiation and termination of trusted channel.</htm:TD>
                  <htm:TD>Trusted channel protocol. Non-TOE endpoint of connection.</htm:TD>
                </htm:TR>
              </htm:table>
              <htm:br/><htm:br/>
            </note>            
          </f-element>
          <f-element>
            <title><htm:b>Refinement:</htm:b> The <selectables>
                <selectable>TSF</selectable>
                <selectable>TOE platform</selectable>
              </selectables> shall record within each <abbr linkend="MDM"/> Agent audit record at
              least the following information: <htm:ol type="a">
                <htm:li>Date and time of the event, type of event, subject identity, (if relevant) the outcome 
                  (success or failure) of the event, and additional information in <ctr-ref ref-id="audit"/>; and</htm:li>         
                <htm:li>For each audit event type, based on the auditable event definitions of the functional components 
                  included in the PP-Module/ST, <assignable>other audit relevant information</assignable>.</htm:li>
              </htm:ol>
            </title>
            <note role="application">All audits must contain at least the information mentioned in
              FAU_GEN.1.2(2), but may contain more information which can be assigned. The <abbr
                linkend="ST"/> author must identify in the <abbr linkend="TSS"/> which information
              of the audit record that is performed by the <abbr linkend="MDM"/> Agent and that
              which is performed by the <abbr linkend="MDM"/> Agent’s platform.<htm:br/><htm:br/>
            </note>
            <aactivity>
              <TSS>
                  The evaluator shall check the <abbr linkend="TSS"/> and ensure that it provides a format for audit records. Each audit record format type must be covered, along with a brief description of each field. <htm:br/><htm:br/> 
                  If "invoke platform-provided functionality" is selected, the evaluator shall examine the <abbr linkend="TSS"/> to verify that it describes (for each supported platform) how this functionality is invoked (it should be noted that this may be through a mechanism that is not implemented by the <abbr linkend="MDM"/> Agent; nonetheless, that mechanism will be identified in the <abbr linkend="TSS"/> as part of this evaluation activity).<htm:br/><htm:br/> 
              </TSS>
              <Tests>
                  The evaluator shall use the <abbr linkend="TOE"/> to perform the auditable
                  events defined in the Auditable Events table in FAU_GEN.1.1(2) and observe that
                  accurate audit records are generated with contents and formatting consistent with
                  those described in the <abbr linkend="TSS"/>. Note that this testing can be
                  accomplished in conjunction with the testing of the security mechanisms
                  directly.<htm:br/><htm:br/>                                 
              </Tests>
            </aactivity>
          </f-element>
        </f-component>
        <f-component cc-id="fau_sel.1" name="Security Audit Event Selection" iteration="EVENTSEL">
          <consistency-rationale/>
          <f-element>
            <title><htm:b>Refinement:</htm:b> The <abbr linkend="TSF"/> shall <selectables>
                <selectable>invoke platform-provided functionality</selectable>
                <selectable>implement functionality</selectable>
              </selectables> to select the set of events to be audited from the set of all auditable
              events based on the following attributes: <htm:ol type="a">
                <htm:li>[<htm:i>event type</htm:i>]</htm:li>
                <htm:li>[<htm:i>success of auditable security events, failure of auditable security events, 
                  <assignable>other attributes</assignable></htm:i>].</htm:li>
              </htm:ol></title>
            <note role="application">The intent of this requirement is to identify all criteria that
              can be selected to trigger an audit event. For the <abbr linkend="ST"/> author, the
              assignment is used to list any additional criteria or “no other attributes”. This selection may be
              configured by the MDM Server.<htm:br/><htm:br/>
            </note>
            <aactivity>
              <TSS>If "invoke platform-provided functionality" is selected, the evaluator shall
                examine the <abbr linkend="TSS"/> of the <abbr linkend="ST"/> to verify that it
                describes (for each supported platform) how this functionality is invoked (it should
                be noted that this may be through a mechanism that is not implemented by the MDM
                Agent; nonetheless, that mechanism will be identified in the <abbr linkend="TSS"/>
                as part of this evaluation activity).<htm:br/><htm:br/>
              </TSS>
              <Guidance>The evaluator shall examine the operational guidance to determine that it
                contains instructions on how to define the set of auditable events as well as
                explains the syntax for multi-value selection (if applicable). The evaluator shall
                also verify that the operational guidance shall identify those audit records that
                are always recorded, regardless of the selection criteria currently being
                enforced.<htm:br/><htm:br/>
              </Guidance>
              <Tests>
                <testlist>
                  <test>For each attribute listed in the requirement, the evaluator shall devise a
                    test to show that selecting the attribute causes only audit events with that
                    attribute (or those that are always recorded, as identified in the
                    administrative guidance) to be recorded.
                  </test>
                  <test>[conditional]: If the TSF supports specification of more complex audit
                    pre-selection criteria (e.g., multiple attributes, logical expressions using
                    attributes) then the evaluator shall devise tests showing that this capability
                    is correctly implemented. The evaluator shall also, in the test plan, provide a
                    short narrative justifying the set of tests as representative and sufficient to
                    exercise the capability.
                  </test>
                </testlist>
              </Tests>
            </aactivity>
          </f-element>
        </f-component>
      </subsection>
      <subsection id="fia" title="Identification and Authentication (FIA)">
        <ext-comp-def title="Enrollment" fam-id="FIA_ENR_EXT">
          <mod-def> This family is defined in the <abbr linkend="MDM"/>
            <abbr linkend="Base-PP"/>. This <abbr linkend="PP-Module"/> augments the extended family
            by adding one additional component, FIA_ENR_EXT.2. This new component and its impact on
            the extended family’s component leveling are shown below; reference the <abbr
              linkend="MDM"/> PP for all other definitions for this family. </mod-def>
        </ext-comp-def>
        <f-component cc-id="fia_enr_ext.2" name="Agent Enrollment of Mobile Device into Management">
          <consistency-rationale/>
          <comp-lev> requires the TSF to record specific information about the <abbr linkend="MDM"/>
            Server (i.e. the entity that is enrolling it) during the enrollment process.</comp-lev>
          <management>There are no management functions foreseen.</management>
          <audit>The following actions should be auditable if FAU_GEN Security audit data generation
            is included in the PP/ST:<htm:ul>
              <htm:li>Minimal: Completion of enrollment process.</htm:li>
            </htm:ul>
          </audit>
          <dependencies>FIA_ENR_EXT.1 Enrollment of Mobile Device into Management</dependencies>
          <f-element>
            <title>The <abbr linkend="MDM"/> Agent shall record the reference identifier of the
                <abbr linkend="MDM"/> Server during the enrollment process. </title>
            <note role="application">The reference identifier of the <abbr linkend="MDM"/> Server
              may be the Distinguished Name, Domain Name, and/or the IP address of the <abbr
                linkend="MDM"/> Server. This requirement allows the specification of the information
              to be to be used to establish a network connection and the reference identifier for
              authenticating the trusted channel between the <abbr linkend="MDM"/> Server and <abbr
                linkend="MDM"/> Agent.<htm:br/><htm:br/>
            </note>
            <aactivity>
              <TSS>The evaluator shall examine the <abbr linkend="TSS"/> to verify that it describes
                which types of reference identifiers are acceptable and how the identifier is
                specified (e.g. preconfigured in the <abbr linkend="MDM"/> Agent, by the user, by
                the <abbr linkend="MDM"/> server, in a policy).<htm:br/><htm:br/>
              </TSS>
              <Guidance>The evaluator shall examine the operational guidance to verify that it
                describes how to configure reference identifier of the <abbr linkend="MDM"/>
                Server’s certificate and, if different than the reference identifier, the Domain
                Name or IP address (for connectivity) of the <abbr linkend="MDM"/>
                Server.<htm:br/><htm:br/>
              </Guidance>
              <Tests>The evaluator shall follow the operational guidance to establish the reference
                identifier of the <abbr linkend="MDM"/> server on the <abbr linkend="MDM"/> Agent
                and in conjunction with other evaluation activities verify that the <abbr
                  linkend="MDM"/> Agent can connect to the <abbr linkend="MDM"/> Server and validate
                the <abbr linkend="MDM"/> Server’s certificate.<htm:br/><htm:br/>
              </Tests>
            </aactivity>
          </f-element>
        </f-component>
      </subsection>
      <subsection id="fmt" title="Security Management (FMT)">
        <ext-comp-def title="Trusted Policy Update" fam-id="FMT_POL_EXT">
          <mod-def> This family is defined in the <abbr linkend="MDM"/>
            <abbr linkend="Base-PP"/>. This <abbr linkend="PP-Module"/> augments the extended family
            by adding one additional component, FMT_POL_EXT.2. This new component and its impact on
            the extended family’s component leveling are shown below; reference the <abbr
              linkend="MDM"/> PP for all other definitions for this family.</mod-def>
        </ext-comp-def>
        <f-component cc-id="fmt_pol_ext.2" name="Agent Trusted Policy Update">
          <consistency-rationale/>
          <comp-lev> requires the TSF to verify the validity of the source of a policy before
            applying it.</comp-lev>
          <management>There are no management functions foreseen.</management>
          <audit>The following actions should be auditable if FAU_GEN Security audit data generation
            is included in the PP/ST:<htm:ul>
              <htm:li>Minimal: Failure to validate policy.</htm:li>
            </htm:ul>
          </audit>
          <dependencies>FCS_COP.1 Cryptographic Operation<htm:br/> FMT_POL_EXT.1 Trusted Policy
            Update </dependencies>
          <f-element>
            <title>The <abbr linkend="MDM"/> Agent shall only accept policies and policy updates
              that are digitally signed by a certificate that has been authorized for policy updates
              by the <abbr linkend="MDM"/> Server. </title>
            <note role="application">The intent of this requirement is to cryptographically tie the
              policies to the enterprise that mandated the policy, not to protect the policies in
              transit (as they are already protected by FPT_ITT.1(2) of the <abbr linkend="Base-PP"/>). This is especially critical for
              users who connect to multiple enterprises.<htm:br/><htm:br/> Policies must be
              digitally signed by the enterprise using the algorithms in
              FCS_COP.1(3).<htm:br/><htm:br/>
            </note>           
          </f-element>
          <f-element>
            <title>The MDM Agent shall not install policies if the policy-signing certificate is
              deemed invalid. </title>
            <aactivity>
                <TSS>
                The evaluator ensures that the <abbr linkend="TSS"/> describes how the candidate policies are obtained by the <abbr linkend="MDM"/> Agent, the processing associated with verifying the digital signature of the policy updates, and the actions that take place for successful (signature was verified) and unsuccessful (signature could not be verified) cases. The software components that are performing the processing must also be identified in the <abbr linkend="TSS"/> and verified by the evaluators.<htm:br/><htm:br/>
                </TSS>
              <Tests> 
                  This evaluation activity is performed in conjunction with the evaluation activity for FIA_X509_EXT.1 and FIA_X509_EXT.2 as defined in the <abbr linkend="Base-PP"/>s.<htm:br/><htm:br/>
                  <testlist>
                      <test>The evaluator shall perform a policy update from an available configuration interface (such as through a test <abbr linkend="MDM"/> Server). The evaluator shall verify the update is signed and is provided to the <abbr linkend="MDM"/> Agent. The evaluator shall verify the <abbr linkend="MDM"/> Agent accepts the digitally signed policy.</test>
                      <test>The evaluator shall perform a policy update from an available configuration interface (such as through a test <abbr linkend="MDM"/> Server). The evaluator shall provide an unsigned and an incorrectly signed policy to the <abbr linkend="MDM"/> Agent. The evaluator shall verify the <abbr linkend="MDM"/> Agent does not accept the digitally signed policy.</test>
                  </testlist>            
              </Tests>
            </aactivity>
          </f-element>
        </f-component>
        <ext-comp-def title="Specification of Management Functions (Agent)" fam-id="FMT_SMF_EXT">
          <mod-def> This family is defined in the MDF <abbr linkend="Base-PP"/>. This <abbr
              linkend="PP-Module"/> augments the extended family by adding one additional component,
            FMT_SMF_EXT.4. This new component and its impact on the extended family’s component
            leveling are shown below; reference the MDF PP for all other definitions for this
            family. </mod-def>
        </ext-comp-def>
        <f-component cc-id="fmt_smf_ext.4" name="Specification of Management Functions">
          <!-- Note: Changed to .4 to avoid conflict with MDM Server -->
          <consistency-rationale> </consistency-rationale>
          <comp-lev> requires the TSF to support the execution of certain management functions that
            require interfacing with other TOE components.</comp-lev>
          <management>The following actions could be considered for the management functions in FMT:<htm:ul>
              <htm:li>Execution of management functions.</htm:li>
              <htm:li>Configuration of management functions behavior.</htm:li>
            </htm:ul>
          </management>
          <audit>The following actions should be auditable if FAU_GEN Security audit data generation
            is included in the PP/ST:<htm:ul>
              <htm:li>Minimal: Successful and failed execution of management functions.</htm:li>
            </htm:ul>
          </audit>
          <dependencies>FCS_CKM.1 Cryptographic Key Generation</dependencies>
          <f-element>
            <title>The <abbr linkend="MDM"/> Agent shall be capable of interacting with the platform
              to perform the following functions: <htm:ul>
                <htm:li>Import the certificates to be used for authentication of <abbr linkend="MDM"
                  /> Agent communications,</htm:li>
                <htm:li><selectables>
                    <selectable>administrator-provided management functions in MDF <abbr
                        linkend="PP"/></selectable>
                    <selectable>administrator-provided device management functions in <abbr
                        linkend="MDM"/>
                      <abbr linkend="PP"/></selectable>
                  </selectables></htm:li>
                <htm:li><selectables>
                    <selectable><assignable>additional functions</assignable></selectable>
                    <selectable> no additional functions</selectable>
                  </selectables>.</htm:li>
              </htm:ul>
            </title>
            <note role="application"> This requirement captures all the configuration functionality
              in the <abbr linkend="MDM"/> Agent to configure the underlying mobile device with the
              configuration policies sent from the <abbr linkend="MDM"/> Server to the Agent. The
                <abbr linkend="ST"/> author selects the <abbr linkend="Base-PP"/> (MDF <abbr
                linkend="PP"/> or <abbr linkend="MDM"/>
              <abbr linkend="PP"/>) as the source of the management functions.<htm:br/><htm:br/> The
              administrator-provided management functions in MDF <abbr linkend="PP"/> are specified
              in Column 4 of Table 5 in MDF <abbr linkend="PP"/> and in FPT_TUD_EXT.1 (for version
              queries). The administrator-provided device management functions in <abbr
                linkend="MDM"/>
              <abbr linkend="PP"/> are specified in FMT_SMF.1.1(1); the functions in the selection
              of FMT_SMF.1.1(1) in the <abbr linkend="MDM"/>
              <abbr linkend="PP"/> are required to correspond to the functions available on the
              platforms supported by the <abbr linkend="MDM"/> Agent.<htm:br/><htm:br/> The <abbr
                linkend="ST"/> author can add more commands and configuration policies by completing
              the assignment statement; the mobile device must support these additional commands or
              configuration policies.<htm:br/><htm:br/> The agent must configure the platform based
              on the commands and configuration policies received from the <abbr linkend="MDM"/>
              Server. The <abbr linkend="ST"/> author must not claim any functionality not provided
              by the supported mobile device(s). All selections and assignments performed by the
                <abbr linkend="ST"/> author in this requirement should match the selections and
              assignments of the validated mobile device <abbr linkend="ST"/>.<htm:br/><htm:br/>
            </note>           
          </f-element>
          <f-element>
            <title>The <abbr linkend="MDM"/> Agent shall be capable of performing the following
              functions: <htm:ul>
                <htm:li>Enroll in management</htm:li>
                <htm:li>Configure whether users can unenroll from management</htm:li>
                <htm:li>
                  <selectables>
                    <selectable>configure periodicity of reachability events</selectable>
                    <selectable><assignable>other management functions</assignable></selectable>
                    <selectable>no other functions</selectable>
                  </selectables>.</htm:li>
              </htm:ul></title>
            <note role="application"> This requirement captures all of the configuration in the
                <abbr linkend="MDM"/> Agent for configuration of itself.<htm:br/><htm:br/> If the
                <abbr linkend="MDM"/> Agent is a part of the mobile device, enrollment is a single
              function both of the Agent and of the mobile device
              (FMT_SMF_EXT.4.1).<htm:br/><htm:br/> If the <abbr linkend="MDM"/> Agent is an
              application developed separately from the mobile device, the <abbr linkend="MDM"/>
              Agent performs the function “enroll the mobile device in management” (per
              FMT_SMF_EXT.4.1) by registering itself to the mobile device as a device administrator.
              The Agent itself is enrolled in management by configuring the <abbr linkend="MDM"/>
              Server to which the Agent answers.<htm:br/><htm:br/> If the <abbr linkend="MDM"/>
              Agent does not support unenrollment prevention, remediation actions should be applied
              upon unenrollment (per FMT_UNR_EXT.1).<htm:br/><htm:br/> If the Agent generates
              periodic reachability events in FAU_ALT_EXT.2.1 and the periodicity of these events is
              configurable, “configure periodicity of reachability events” must be
              selected.<htm:br/><htm:br/>
            </note> 
            <aactivity>
                <!-- TODO: Need to move below sentence -->
                This assurance activity may be performed in conjunction with other assurance
                activities in the <abbr linkend="Base-PP"/>.<htm:br/><htm:br/>
                
              <TSS> 
                  The evaluator shall verify that the any assigned functions are described in the <abbr linkend="TSS"/> and that these functions are documented as supported by the platform. The evaluator shall examine the <abbr linkend="TSS"/> to verify that any differences between management functions and policies for each supported mobile device are listed.<htm:br/><htm:br/>
                  The evaluator shall verify that the <abbr linkend="TSS"/> describes the methods in which the MDM Agent can be enrolled.<htm:br/><htm:br/> 
                  The <abbr linkend="TSS"/> description shall make clear if the MDM Agent supports multiple interfaces for enrollment and configuration (for example, both remote configuration and local configuration).<htm:br/><htm:br/>                  
              </TSS>
              <Guidance> 
                  The evaluator shall verify the AGD guidance includes detailed instructions for configuring each function in this requirement.<htm:br/><htm:br/> 
                  If the <abbr linkend="MDM"/> Agent is a component of the <abbr linkend="MDM"/> system (i.e. <abbr linkend="MDM"/> Server is the <abbr linkend="Base-PP"/>), the evaluator shall verify, by consulting documentation for the claimed mobile device platforms, that the configurable functions listed for this Agent are supported by the platforms.<htm:br/><htm:br/> 
                  If the <abbr linkend="MDM"/> Agent supports multiple interfaces for configuration (for example, both remote configuration and local configuration), the AGD guidance makes clear whether some functions are restricted to certain interfaces.<htm:br/><htm:br/>                
              </Guidance>
              <Tests>
                <testlist>
                    <test>In conjunction with the evaluation activities in the <abbr linkend="Base-PP"/>, the evaluator shall attempt to configure each administrator-provided management function and shall verify that the mobile device executes the commands and enforces the policies.</test>
                  <test>The evaluator shall configure the MDM Agent authentication certificate in accordance with the configuration guidance. The evaluator shall verify that the MDM Agent uses this certificate in performing the tests for FPT_ITT.1(2) (from the MDM PP).</test>
                    <test>In conjunction with other evaluation activities, the evaluator shall attempt to enroll the MDM Agent in management with each interface identified in the <abbr linkend="TSS"/>, and verify that the MDM Agent can manage the device and communicate with the MDM Server.</test>
                    <test>[conditional] In conjunction with the evaluation activity for FAU_ALT_EXT.2.1, the evaluator shall configure the periodicity for reachability events for several configured time periods and shall verify that the MDM Server receives alerts on that schedule.</test>
                  <test>[conditional] The evaluator shall design and perform tests to demonstrate that the assigned function may be configured and that the intended behavior of the function is enacted by the mobile device.</test>
                </testlist>
              </Tests>
            </aactivity>
          </f-element>
        </f-component>
        <ext-comp-def title="Unenrollment" fam-id="FMT_UNR_EXT">
          <fam-behavior> Components in this family define requirements for TSF behavior when a user
            attempts to unenroll the TOE from mobile device management.</fam-behavior>
        </ext-comp-def>
        <f-component cc-id="fmt_unr_ext.1" name="User Unenrollment Prevention">
          <consistency-rationale/>
          <comp-lev> requires the TSF either to prevent unenrollment entirely or to take some
            corrective action in the event that an unenrollment is initiated.</comp-lev>
          <management>There are no management functions foreseen.</management>
          <audit>The following actions should be auditable if FAU_GEN Security audit data generation
            is included in the PP/ST:<htm:ul>
              <htm:li>Minimal: Unenrollment from <abbr linkend="MDM"/>.</htm:li>
            </htm:ul>
          </audit>
          <dependencies> [FIA_ENR_EXT.1 Enrollment of Mobile Device into Management; or<htm:br/>
            FMT_MOF_EXT.1 Management of Functions Behavior] </dependencies>
          <f-element>
            <title>The <abbr linkend="MDM"/> Agent shall provide a mechanism to enforce the
              following behavior upon an attempt to unenroll the mobile device from management: <selectables>
                <selectable>prevent the unenrollment from occurring</selectable>
                <selectable>apply remediation actions</selectable>
              </selectables>.
            </title>
            <note role="application">Unenrolling is the action of transitioning from the enrolled
              state to the unenrolled state. If preventing the user from unenrolling is
              configurable, administrators configure whether users are allowed to unenroll through
              the <abbr linkend="MDM"/> Server.<htm:br/><htm:br/> For those configurations where
              unenrollment is allowed, for example a BYOD usage, the MDF PP describes remediation
              actions performed upon unenrollment, such as wiping enterprise data, in
              FMT_SMF_EXT.2.1; however, the <abbr linkend="MDM"/> Agent is limited to those actions
              supported by the mobile device on which the Agent is operating.<htm:br/><htm:br/>
            </note>
            <aactivity>
              <TSS> The evaluator shall ensure that the <abbr linkend="TSS"/> describes the
                mechanism used to prevent users from unenrolling or the remediation actions applied
                when unenrolled.<htm:br/><htm:br/>
              </TSS>
              <Guidance> The evaluator shall ensure that the administrative guidance instructs
                administrators in configuring the unenrollment prevention in each available
                configuration interface. If any configuration allows users to unenroll, the guidance
                also describes the actions that unenroll the Agent.<htm:br/><htm:br/>
              </Guidance>
              <Tests>
                <testlist>
                  <test>If ‘prevent the unenrollment from occurring’ is selected: The evaluator shall configure the Agent according to the administrative guidance for each available configuration interface, shall attempt to unenroll the device, and shall verify that the attempt fails.
                  </test>
                  <test>If ‘apply remediation actions’ is selected: If any configuration allows the user to unenroll, the evaluator shall configure the Agent to allow user unenrollment, attempt to unenroll, and verify that the remediation actions are applied.
                  </test>
                </testlist>
              </Tests>
            </aactivity>
          </f-element>
        </f-component>
      </subsection>
    </man-sfrs>
    <opt-sfrs/>
    <sel-sfrs/>
    <obj-sfrs>
      <subsection id="fau" title="Security Audit (FAU)">
        <ext-comp-def title="Protected Audit Event Storage" fam-id="FAU_STG_EXT">
          <mod-def>This family is defined in the <abbr linkend="MDM"/>
            <abbr linkend="Base-PP"/>. This <abbr linkend="PP-Module"/> augments the extended family
            by adding one additional component, FAU_STG_EXT.3. This new component and its impact on
            the extended family’s component leveling are shown below; reference the <abbr
              linkend="MDM"/> PP for all other definitions for this family.</mod-def>
        </ext-comp-def>
        <f-component cc-id="fau_stg_ext.3" name="Security Audit Event Storage">
          <!-- Note: Name changed simply to avoid name collision with MDM Server -->
          <consistency-rationale/>
          <comp-lev> requires the TSF to identify a location for audit record storage and the events
            that are stored at this location.</comp-lev>
          <management>There are no management functions foreseen.</management>
          <audit>There are no auditable events foreseen.</audit>
          <dependencies>FAU_GEN.1 Audit Data Generation</dependencies>
          <f-element>
            <title>The MDM Agent shall store MDM audit records in the platform-provided audit storage. </title>
            <note role="application">FAU_STG_EXT.3 should only be included in the <abbr linkend="ST"
              /> for MDM Agent platforms (i.e., mobile devices) that conform to MDF PP version 3 or later.<htm:br/><htm:br/>
            </note>
            <aactivity>
              <TSS>The evaluator shall verify that the <abbr linkend="TSS"/> description of the
                audit records indicates how the records are stored. The evaluator shall verify that
                the Agent calls a platform-provided API to store audit records.<htm:br/><htm:br/>
              </TSS>
            </aactivity>
          </f-element>
        </f-component>
      </subsection>
      <subsection title="Protection of the TSF (FPT)" id="fpt">
        <ext-comp-def title="Network Reachability" fam-id="FPT_NET_EXT">
          <fam-behavior> Components in this family define requirements for tracking the availability
            of network components. </fam-behavior>
        </ext-comp-def>
        <f-component cc-id="fpt_net_ext.1" name="Network Reachability">
          <consistency-rationale/>
          <comp-lev> requires the TSF to keep track of failed attempts to communicate with a remote
            entity.</comp-lev>
          <management>The following actions could be considered for the management functions in FMT:<htm:br/>
            <htm:ul>
              <htm:li>Configuration of unreachability threshold.</htm:li></htm:ul>
          </management>
          <audit>The following actions should be auditable if FAU_GEN Security audit data generation
            is included in the PP/ST:<htm:ul>
              <htm:li>Minimal: Reaching/exceeding unreachability threshold.</htm:li></htm:ul>
          </audit>
          <dependencies>FPT_STM.1 Reliable Time Stamps</dependencies>
          <f-element>
            <title>The TSF shall detect when a configurable <selectables>
                <selectable>positive integer of missed reachability events occur</selectable>
                <selectable>time limit is exceeded</selectable>
              </selectables> related to the last successful connection with the server has been
              reached. </title>
            <note role="application"> This requirement is to enable the Agent to determine if it has
              been out of connectivity with the Server for too long. The configuration of the number
              of allowed missed reachability events or time limit since last successful connection
              with the server is handled in Server configuration policy of the Agent (the first selection of
              function 56 in FMT_SMF.1.1(1) within the MDM PP). If the first selection of FMT_SMF.1.1(1) function 56 is included in the <abbr linkend="ST"/>,
              then FPT_NET_EXT.1.1 must be included in the <abbr linkend="ST"/>.<htm:br/><htm:br/> If the Agent has been out of connectivity with the server for
              too long than the remediation actions specified in the second selection of function 56 must occur. For
              example if the Agent has not synced with the server in the allowed amount of time that
              the Agent must wipe the device without requiring a command from the
              Server.<htm:br/><htm:br/>
            </note>
            <aactivity>
              <TSS> The evaluator shall verify that the <abbr linkend="TSS"/> contains a description
                of how the Agent determines how long it has been since the last successful
                connection with the Server (i.e., total number of missed reachability events or
                time). If total number of missed reachability events is selected, the evaluator
                shall verify that the <abbr linkend="TSS"/> contains a description of how often the
                reachability events are sent.<htm:br/><htm:br/>
              </TSS>
              <Guidance> The evaluator shall verify that the AGD guidance instructs the
                administrator, if needed, how to configure the <abbr linkend="TOE"/> to detect when
                the time since last successful connection with the server has been
                reached.<htm:br/><htm:br/>
              </Guidance>
              <Tests> The evaluator shall configure the Server configuration policy of the Agent per
                FMT_SMF.1.1(1) function 56 within the Mobile Device Managment PP. The device shall be placed in airplane mode to prevent
                connectivity with the Server. The evaluator shall verify that after the configured
                time, the remediation actions selected in function 56 occur.<htm:br/><htm:br/>
              </Tests>
            </aactivity>
          </f-element>
        </f-component>
      </subsection>
    </obj-sfrs>
  </chapter>


  <appendix id="use-case" title="Use Case Templates"> The following use case templates list those
    selections, assignments, and objective requirements that best support the use cases identified
    by this Protection Profile. Note that the templates assume that all <abbr linkend="SFR"/>s
    listed in Section 5 are included in the <abbr linkend="ST"/>, not just those listed in the
    templates. These templates and deviations from the template should be identified in the Security
    Target to assist customers with making risk-based purchasing decisions. Products that do not
    meet these templates are not precluded from use in the scenarios identified by this Protection
    Profile.<htm:br/><htm:br/> Where selections for a particular requirement are not identified in a
    use case template, all available selections are equally applicable to the use case.<htm:br/><htm:br/>
    <usecase id="usecase1" title="Enterprise-owned device for general-purpose enterprise use">
      <description>
        <htm:b>[Use Case 1] Enterprise-owned device for general-purpose enterprise use</htm:b>
        <htm:br/><htm:br/> At this time no additional requirements are recommended for this use
        case.<htm:br/><htm:br/>
      </description>
    </usecase>
    <usecase title="Enterprise-owned device for specialized, high-security use" id="usecase2">
      <description>
        <htm:b>[Use Case 2] Enterprise-owned device for specialized, high-security use</htm:b>
        <htm:table>
          <htm:tr>
            <htm:th>Requirement</htm:th>
            <htm:th>Action</htm:th>
          </htm:tr>
          <htm:tr>
            <htm:td>FAU_ALT_EXT.2.1 Function c</htm:td>
            <htm:td>Include in <abbr linkend="ST"/>.</htm:td>
          </htm:tr>
          <htm:tr>
            <htm:td>FMT_UNR_EXT.1.1</htm:td>
            <htm:td>Select “prevent the unenrollment from occurring”.</htm:td>
          </htm:tr>
        </htm:table>
        <htm:br/><htm:br/>
      </description>
    </usecase>
    <usecase title="Personally owned device for personal and enterprise use" id="usecase3">
      <description>
        <htm:b>[Use Case 3] Personally owned device for personal and enterprise use</htm:b>
        <htm:table>
          <htm:tr>
            <htm:th>Requirement</htm:th>
            <htm:th>Action</htm:th>
          </htm:tr>
          <htm:tr>
            <htm:td>FMT_UNR_ENT.1.1</htm:td>
            <htm:td>Select “apply remediation actions”</htm:td>
          </htm:tr>
        </htm:table>
        <htm:br/><htm:br/>
      </description>
    </usecase>
    <usecase title="Personally owned device for personal and limited enterprise" id="usecase4">
      <description><htm:b>[Use Case 4] Personally owned device for personal and limited enterprise
          use</htm:b><htm:br/><htm:br/> At this time no additional requirements are recommended for
        this use case.</description>
    </usecase>
  </appendix>

  <bibliography>
    <cc-entry/>
  </bibliography>
  <acronyms/>
    <!-- ToDo: Are these really the only acronyms?-->
      <!-- <term abbr="TOE" full="Target of Evaluation"/> -->
      <!-- <term abbr="TSF" full="TOE Summary Functionality"/> -->
      <!-- <term abbr="TSS" full="TOE Security Specification"/> -->

</Module>
<!--  
  <appendix id="references" title="References">
    <htm:table>
      <htm:tr>
        <htm:th>Identifier</htm:th>
        <htm:th>Title</htm:th>
      </htm:tr>
      <htm:tr>
        <htm:td>[CC]</htm:td>
        <htm:td>
          Common Criteria for Information Technology Security Evaluation –
          <htm:ul>
            
            <htm:li>Part 1: Introduction and General Model, CCMB-2012-09-001, Version 3.1 Revision 4, September 2012</htm:li>
            <htm:li>Part 2: Security Functional Components, CCMB-2012-09-002, Version 3.1 Revision 4, September 2012</htm:li>
            <htm:li>Part 3: Security Assurance Components, CCMB-2012-09-003, Version 3.1 Revision 4, September 2012</htm:li>
          </htm:ul>
        </htm:td>
      </htm:tr>
      <htm:tr>
        <htm:td>[<abbr linkend="CEM"/>]</htm:td>
        <htm:td>Common Methodology for Information Technology Security Evaluation, Evaluation Methodology, CCMB-2012-09-004, Version 3.1 Revision 4, September 2012</htm:td>
      </htm:tr>
      <htm:tr>
        <htm:td>[MDF <abbr linkend="PP"/>]</htm:td>
        <htm:td>Protection Profile for Mobile Device Fundamentals, Version 3.0, June 2016</htm:td>
      </htm:tr>
      <htm:tr>
        <htm:td>[MDM <abbr linkend="PP"/>]</htm:td>
        <htm:td>Protection Profile for Mobile Device Management, Version 3.0, November 2016</htm:td>
      </htm:tr>
    </htm:table>
    <htm:br/><htm:br/>
  </appendix>
  <appendix id="acronyms" title="Acronyms">
    
  </appendix>
  -->
